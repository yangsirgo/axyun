/* 
 * 安想智慧医疗--电子病历编辑器 
 * author jianhui jia 
 * createtime 2019-05-28 15:56:53 
 * updatetime 2019-09-17 02:54:38 
 * version 1.0.0 
 */
function getCLodop(){return window.CLODOP2015_7028}!function(a){var b={strWebPageID:"7BCAAAg",strTaskID:"",strHostURI:"http://localhost:8000",VERSION:"6.2.2.6",IVERSION:"6226",CVERSION:"3.0.8.3",HTTPS_STATUS:0,VERSION_EXT:!1,iBaseTask:0,timeThreshold:5,Priority:0,blIslocal:!0,Iframes:[],ItemDatas:{},PageData:{},defStyleJson:{},PageDataEx:{},ItemCNameStyles:{},blWorking:!1,blNormalItemAdded:!1,blTmpSelectedIndex:null,Caption:null,Color:null,CompanyName:null,strBroadcastMS:null,Border:null,Inbrowse:null,webskt:null,SocketEnable:!1,SocketOpened:!1,NoClearAfterPrint:!1,On_Return_Remain:!1,On_Broadcast_Remain:!1,On_Return:null,Result:null,iTrySendTimes:0,blOneByone:!1,DelimChar:"\f\f",Printers:{"default":"1",list:[{name:"OneNote",DriverName:"Microsoft Software Printer Driver",PortName:"Microsoft.Office.OneNote_16001.11901.20096.0_x64__8wekyb3d8bbwe_microsoft.onenoteim_S-1-5-21-870739724-2543615109-746846974-1001",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"300",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2159",MaxExtentLength:"2970",MinExtentWidth:"2100",MinExtentlength:"2794",pagelist:[{name:"信纸"},{name:"A4"}]},{name:"HP LaserJet Pro MFP M225-M226 PCL 6 (副本 1)",DriverName:"HP LaserJet Pro MFP M225-M226 PCL 6",PortName:"192.168.12.200",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2159",MaxExtentLength:"3556",MinExtentWidth:"762",MinExtentlength:"1270",pagelist:[{name:"信纸"},{name:"法律专用纸"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"11x17"},{name:"信封 #10"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 B5"},{name:"信封 Monarch"},{name:"日式明信片"},{name:"A6"},{name:"双层日式明信片旋转"},{name:"B6 (JIS)"},{name:"Oficio 8.5x13"},{name:"4x6"},{name:"5x8"},{name:"10x15 厘米"},{name:"Oficio 216x340 mm"},{name:"16K 184x260 毫米"},{name:"16K 195x270 毫米"},{name:"16K 197x273 mm"},{name:"11x17 英寸"},{name:"8K 273x394 毫米"},{name:"8K 270x390 毫米"},{name:"8K 260x368 毫米"}]},{name:"NPIEF90AC (HP LaserJet Pro MFP M226dw)",DriverName:"HP LaserJet Pro MFP M225-M226 PCL 6",PortName:"WSD-44aedfbe-cab8-415a-af24-a744c700a275",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2159",MaxExtentLength:"3556",MinExtentWidth:"762",MinExtentlength:"1270",pagelist:[{name:"信纸"},{name:"法律专用纸"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"11x17"},{name:"信封 #10"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 B5"},{name:"信封 Monarch"},{name:"日式明信片"},{name:"A6"},{name:"双层日式明信片旋转"},{name:"B6 (JIS)"},{name:"Oficio 8.5x13"},{name:"4x6"},{name:"5x8"},{name:"10x15 厘米"},{name:"Oficio 216x340 mm"},{name:"16K 184x260 毫米"},{name:"16K 195x270 毫米"},{name:"16K 197x273 mm"},{name:"11x17 英寸"},{name:"8K 273x394 毫米"},{name:"8K 270x390 毫米"},{name:"8K 260x368 毫米"}]},{name:"Microsoft XPS Document Writer",DriverName:"Microsoft XPS Document Writer v4",PortName:"PORTPROMPT:",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"270",MaxExtentWidth:"8636",MaxExtentLength:"11176",MinExtentWidth:"900",MinExtentlength:"900",pagelist:[{name:"信纸"},{name:"小号信纸"},{name:"Tabloid"},{name:"Ledger"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A4 小号"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"Folio"},{name:"Quarto"},{name:"10x14"},{name:"11x17"},{name:"便笺"},{name:"信封 #9"},{name:"信封 #10"},{name:"信封 #11"},{name:"信封 #12"},{name:"信封 #14"},{name:"C size sheet"},{name:"D size sheet"},{name:"E size sheet"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 C3"},{name:"信封 C4"},{name:"信封 C6"},{name:"信封 C65"},{name:"信封 B4"},{name:"信封 B5"},{name:"信封 B6"},{name:"信封"},{name:"信封 Monarch"},{name:"6 3/4 信封"},{name:"美国标准 Fanfold"},{name:"德国标准 Fanfold"},{name:"德国法律专用纸 Fanfold"},{name:"B4 (ISO)"},{name:"日式明信片"},{name:"9x11"},{name:"10x11"},{name:"15x11"},{name:"信封邀请函"},{name:"特大信纸"},{name:"特大法律专用纸"},{name:"A4 特大"},{name:"信纸横向"},{name:"A4 横向"},{name:"特大信纸横向"},{name:"Super A"},{name:"Super B"},{name:"信纸加大"},{name:"A4 加大"},{name:"A5 横向"},{name:"B5 (JIS) 横向"},{name:"A3 特大"},{name:"A5 特大"},{name:"B5 (ISO) 特大"},{name:"A2"},{name:"A3 横向"},{name:"A3 特大横向"},{name:"日式往返明信片"},{name:"A6"},{name:"日式信封 Kaku #2"},{name:"日式信封 Kaku #3"},{name:"日式信封 Chou #3"},{name:"日式信封 Chou #4"},{name:"信纸旋转"},{name:"A3 旋转"},{name:"A4 旋转"},{name:"A5 旋转"},{name:"B4 (JIS) 旋转"},{name:"B5 (JIS) 旋转"},{name:"日式明信片旋转"},{name:"双层日式明信片旋转"},{name:"A6 旋转"},{name:"日式信封 Kaku #2 旋转"},{name:"日式信封 Kaku #3 旋转"},{name:"日式信封 Chou #3 旋转"},{name:"日式信封 Chou #4 旋转"},{name:"B6 (JIS)"},{name:"B6 (JIS) 旋转"},{name:"12x11"},{name:"日式信封 You #4"},{name:"日式信封 You #4 旋转"},{name:"PRC 信封 #1"},{name:"PRC 信封 #3"},{name:"PRC 信封 #4"},{name:"PRC 信封 #5"},{name:"PRC 信封 #6"},{name:"PRC 信封 #7"},{name:"PRC 信封 #8"},{name:"PRC 信封 #9"},{name:"PRC 信封 #10"},{name:"PRC 信封 #1 旋转"},{name:"PRC 信封 #3 旋转"},{name:"PRC 信封 #4 旋转"},{name:"PRC 信封 #5 旋转"},{name:"PRC 信封 #6 旋转"},{name:"PRC 信封 #7 旋转"},{name:"PRC 信封 #8 旋转"},{name:"PRC 信封 #9 旋转"},{name:"用户定义大小"}]},{name:"Microsoft Print to PDF",DriverName:"Microsoft Print To PDF",PortName:"PORTPROMPT:",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2970",MaxExtentLength:"4318",MinExtentWidth:"1397",MinExtentlength:"2100",pagelist:[{name:"信纸"},{name:"Tabloid"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"}]},{name:"HP LaserJet Pro MFP M225-M226 PCL 6",DriverName:"HP LaserJet Pro MFP M225-M226 PCL 6",PortName:"LPT1:",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2159",MaxExtentLength:"3556",MinExtentWidth:"762",MinExtentlength:"1270",pagelist:[{name:"信纸"},{name:"法律专用纸"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"11x17"},{name:"信封 #10"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 B5"},{name:"信封 Monarch"},{name:"日式明信片"},{name:"A6"},{name:"双层日式明信片旋转"},{name:"B6 (JIS)"},{name:"Oficio 8.5x13"},{name:"4x6"},{name:"5x8"},{name:"10x15 厘米"},{name:"Oficio 216x340 mm"},{name:"16K 184x260 毫米"},{name:"16K 195x270 毫米"},{name:"16K 197x273 mm"},{name:"11x17 英寸"},{name:"8K 273x394 毫米"},{name:"8K 270x390 毫米"},{name:"8K 260x368 毫米"}]},{name:"Foxit Reader PDF Printer",DriverName:"Foxit Reader PDF Printer Driver",PortName:"FOXIT_Reader:",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"7",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1025",DCOrientation:"90",MaxExtentWidth:"32767",MaxExtentLength:"32767",MinExtentWidth:"1",MinExtentlength:"1",pagelist:[{name:"信纸"},{name:"小号信纸"},{name:"Tabloid"},{name:"Ledger"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A4 小号"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"Folio"},{name:"Quarto"},{name:"10x14"},{name:"11x17"},{name:"便笺"},{name:"信封 #9"},{name:"信封 #10"},{name:"信封 #11"},{name:"信封 #12"},{name:"信封 #14"},{name:"C size sheet"},{name:"D size sheet"},{name:"E size sheet"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 C3"},{name:"信封 C4"},{name:"信封 C6"},{name:"信封 C65"},{name:"信封 B4"},{name:"信封 B5"},{name:"信封 B6"},{name:"信封"},{name:"信封 Monarch"},{name:"6 3/4 信封"},{name:"美国标准 Fanfold"},{name:"德国标准 Fanfold"},{name:"德国法律专用纸 Fanfold"},{name:"B4 (ISO)"},{name:"日式明信片"},{name:"9x11"},{name:"10x11"},{name:"15x11"},{name:"信封邀请函"},{name:"Reserved48"},{name:"Reserved49"},{name:"特大信纸"},{name:"特大法律专用纸"},{name:"Tabloid 特大"},{name:"A4 特大"},{name:"信纸横向"},{name:"A4 横向"},{name:"特大信纸横向"},{name:"Super A"},{name:"Super B"},{name:"信纸加大"},{name:"A4 加大"},{name:"A5 横向"},{name:"B5 (JIS) 横向"},{name:"A3 特大"},{name:"A5 特大"},{name:"B5 (ISO) 特大"},{name:"A2"},{name:"A3 横向"},{name:"A3 特大横向"},{name:"日式往返明信片"},{name:"A6"},{name:"日式信封 Kaku #2"},{name:"日式信封 Kaku #3"},{name:"日式信封 Chou #3"},{name:"日式信封 Chou #4"},{name:"信纸旋转"},{name:"A3 旋转"},{name:"A4 旋转"},{name:"A5 旋转"},{name:"B4 (JIS) 旋转"},{name:"B5 (JIS) 旋转"},{name:"日式明信片旋转"},{name:"双层日式明信片旋转"},{name:"A6 旋转"},{name:"日式信封 Kaku #2 旋转"},{name:"日式信封 Kaku #3 旋转"},{name:"日式信封 Chou #3 旋转"},{name:"日式信封 Chou #4 旋转"},{name:"B6 (JIS)"},{name:"B6 (JIS) 旋转"},{name:"12x11"},{name:"日式信封 You #4"},{name:"日式信封 You #4 旋转"},{name:"PRC 16K"},{name:"PRC 32K"},{name:"PRC 32K(Big)"},{name:"PRC 信封 #1"},{name:"PRC 信封 #2"},{name:"PRC 信封 #3"},{name:"PRC 信封 #4"},{name:"PRC 信封 #5"},{name:"PRC 信封 #6"},{name:"PRC 信封 #7"},{name:"PRC 信封 #8"},{name:"PRC 信封 #9"},{name:"PRC 信封 #10"},{name:"PRC 16K 旋转"},{name:"PRC 32K 旋转"},{name:"PRC 32K(大)旋转"},{name:"PRC 信封 #1 旋转"},{name:"PRC 信封 #2 旋转"},{name:"PRC 信封 #3 旋转"},{name:"PRC 信封 #4 旋转"},{name:"PRC 信封 #5 旋转"},{name:"PRC 信封 #6 旋转"},{name:"PRC 信封 #7 旋转"},{name:"PRC 信封 #8 旋转"},{name:"PRC 信封 #9 旋转"},{name:"PRC 信封 #10 旋转"},{name:"Oficio 8.5x13"},{name:"4x6"},{name:"5x8"},{name:"10x15 厘米"},{name:"Oficio 216x340 mm"},{name:"16K 184x260 毫米"},{name:"16K 195x270 毫米"},{name:"16K 197x273 mm"},{name:"11x17 英寸"},{name:"8K 273x394 毫米"},{name:"8K 270x390 毫米"},{name:"8K 260x368 毫米"}]},{name:"Fax",DriverName:"Microsoft Shared Fax Driver",PortName:"SHRFAX:",Orientation:"1",PaperSize:"9",PaperLength:"0",PaperWidth:"0",Copies:"1",DefaultSource:"1",PrintQuality:"200",Color:"1",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1024",DCOrientation:"90",MaxExtentWidth:"2160",MaxExtentLength:"3556",MinExtentWidth:"0",MinExtentlength:"0",pagelist:[{name:"信纸"},{name:"小号信纸"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A4"},{name:"A4 小号"},{name:"A5"},{name:"B5 (JIS)"},{name:"Folio"},{name:"Quarto"},{name:"便笺"},{name:"信封 #9"},{name:"信封 #10"},{name:"信封 #11"},{name:"信封 #12"},{name:"信封 #14"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 C6"},{name:"信封 C65"},{name:"信封 B5"},{name:"信封 B6"},{name:"信封"},{name:"信封 Monarch"},{name:"6 3/4 信封"},{name:"德国标准 Fanfold"},{name:"德国法律专用纸 Fanfold"},{name:"日式明信片"},{name:"Reserved48"},{name:"Reserved49"},{name:"信纸横向"},{name:"A4 横向"},{name:"信纸加大"},{name:"A4 加大"},{name:"A5 横向"},{name:"B5 (JIS) 横向"},{name:"A5 特大"},{name:"B5 (ISO) 特大"},{name:"日式往返明信片"},{name:"A6"},{name:"日式信封 Kaku #3"},{name:"日式信封 Chou #3"},{name:"日式信封 Chou #4"},{name:"A5 旋转"},{name:"日式明信片旋转"},{name:"双层日式明信片旋转"},{name:"A6 旋转"},{name:"日式信封 Chou #4 旋转"},{name:"B6 (JIS)"},{name:"B6 (JIS) 旋转"},{name:"日式信封 You #4"},{name:"PRC 16K"},{name:"PRC 32K"},{name:"PRC 32K(Big)"},{name:"PRC 信封 #1"},{name:"PRC 信封 #2"},{name:"PRC 信封 #3"},{name:"PRC 信封 #4"},{name:"PRC 信封 #5"},{name:"PRC 信封 #6"},{name:"PRC 信封 #7"},{name:"PRC 信封 #8"},{name:"PRC 32K 旋转"},{name:"PRC 32K(大)旋转"},{name:"PRC 信封 #1 旋转"},{name:"PRC 信封 #2 旋转"},{name:"PRC 信封 #3 旋转"},{name:"PRC 信封 #4 旋转"},{name:"Oficio 8.5x13"},{name:"4x6"},{name:"5x8"},{name:"10x15 厘米"},{name:"Oficio 216x340 mm"},{name:"16K 184x260 毫米"},{name:"16K 195x270 毫米"},{name:"16K 197x273 mm"}]}]},altMessageWebSocketInvalid:"WebSocket没准备好，点确定继续...",altMessageNoReadWriteFile:"不能远程读写文件!",altMessageNoReadFile:"不能远程读文件!",altMessageNoWriteFile:"不能远程写文件!",altMessageNoPrintDesign:"不能远程打印设计!",altMessageNoPrintSetup:"不能远程打印维护!",altMessageSomeWindowExist:"有窗口已打开，先关闭它(持续如此时请刷新页面)!",altMessageBusy:"上一个请求正忙，请稍后再试！",Browser:function(){var a=navigator.userAgent,b="[object Opera]"==Object.prototype.toString.call(window.opera);return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&-1===a.indexOf("KHTML"),MobileSafari:/Apple.*Mobile/.test(a)}}(),GetTaskID:function(){if(!this.strTaskID||""==this.strTaskID){var a=new Date;this.iBaseTask++,this.strTaskID=""+a.getHours()+a.getMinutes()+a.getSeconds()+"_"+this.iBaseTask}return this.strWebPageID+this.strTaskID},DoInit:function(){this.strTaskID="",this.NoClearAfterPrint||(this.ItemDatas={count:0},this.PageData={},this.ItemCNameStyles={},this.defStyleJson={beginpage:0,beginpagea:0},this.blNormalItemAdded=!1)},OpenWebSocket:function(){if(!window.WebSocket&&!window.MozWebSocket)return void(window.On_CLodop_Opened&&b.Priority==window.CLODOP_OK_Priority&&setTimeout("window.On_CLodop_Opened(CLODOP)",1));this.SocketEnable=!0;try{this.webskt&&3!=this.webskt.readyState||(!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket),this.webskt=new WebSocket("ws://127.0.0.1:8000/c_webskt/"),this.webskt.onopen=function(a){b.SocketOpened=!0,window.On_CLodop_Opened&&b.Priority==window.CLODOP_OK_Priority&&setTimeout(window.On_CLodop_Opened(b),1)},this.webskt.onmessage=function(a){b.blOneByone=!1;var c=a.data;b.Result=c;try{var d=null,e=c.indexOf("=");if(e>=0&&30>e&&(d=c.slice(0,e),c=c.slice(e+1)),d.indexOf("ErrorMS")>-1)return void alert(c);if(d.indexOf("BroadcastMS")>-1){if(b.strBroadcastMS=c,b.On_Broadcast){var f=b.On_Broadcast;b.On_Broadcast(c),b.On_Broadcast_Remain||f!==b.On_Broadcast||(b.On_Broadcast=null)}return}if(b.On_Return){var f=b.On_Return;"true"==c.toLowerCase()||"false"==c.toLowerCase()?b.On_Return(d,"true"==c.toLowerCase()):b.On_Return(d,c),b.On_Return_Remain||f!==b.On_Return||(b.On_Return=null)}}catch(g){}},this.webskt.onclose=function(a){return b.SocketOpened?void setTimeout(b.OpenWebSocket(),2e3):void(b.SocketEnable=!1)},this.webskt.onerror=function(a){})}catch(a){this.webskt=null,a.message.indexOf("SecurityError")>-1?this.SocketEnable=!1:setTimeout(b.OpenWebSocket(),2e3)}},wsSend:function(a){return this.SocketEnable?this.webskt&&1==this.webskt.readyState?(this.Result=null,this.iTrySendTimes=0,this.webskt.send(a),!0):(alert(this.altMessageWebSocketInvalid),this.iTrySendTimes++,this.iTrySendTimes<=1?setTimeout(b.wsSend(a),500):this.OpenWebSocket(),void 0):void 0},FORMAT:function(a,c){if(this.blWorking)return alert(this.altMessageBusy),null;var d=null;if(void 0!==a&&void 0!==c){if(0==a.replace(/^\s+|\s+$/g,"").toLowerCase().indexOf("time:")){a=a.replace(/^\s+|\s+$/g,"").slice(5),c.toLowerCase().indexOf("now")>-1&&(c=(new Date).toString()),c.toLowerCase().indexOf("date")>-1&&(c=(new Date).toString()),c.toLowerCase().indexOf("time")>-1&&(c=(new Date).toString());var e="ymd";c.toLowerCase().indexOf("ymd")>-1&&(e="ymd",c=c.slice(3)),c.toLowerCase().indexOf("dmy")>-1&&(e="dmy",c=c.slice(3)),c.toLowerCase().indexOf("mdy")>-1&&(e="mdy",c=c.slice(3)),c=c.replace(/ [^ ]*\+[^ ]* /g," "),c=c.replace(/\(.*\)/g," "),c=c.replace(/星期日|星期一|星期二|星期三|星期四|星期五|星期六/g," "),c=c.replace(/[A-Za-z]+day|Mon|Tue|Wed|Thu|Fri|Sat|Sun/g," ");var f=0,g=new RegExp("Oct[A-Za-z]*|十月|10月","i");null!==c.match(g)&&(f=10,c=c.replace(g,"")),g=new RegExp("Nov[A-Za-z]*|十一月|11月","i"),null!==c.match(g)&&(f=11,c=c.replace(g,"")),g=new RegExp("Dec[A-Za-z]*|十二月|12月","i"),null!==c.match(g)&&(f=12,c=c.replace(g,"")),g=new RegExp("Jan[A-Za-z]*|一月|01月|1月","i"),null!==c.match(g)&&(f=1,c=c.replace(g,"")),g=new RegExp("Feb[A-Za-z]*|二月|02月|2月","i"),null!==c.match(g)&&(f=2,c=c.replace(g,"")),g=new RegExp("Mar[A-Za-z]*|三月|03月|3月","i"),null!==c.match(g)&&(f=3,c=c.replace(g,"")),g=new RegExp("Apr[A-Za-z]*|四月|04月|4月","i"),null!==c.match(g)&&(f=4,c=c.replace(g,"")),g=new RegExp("May[A-Za-z]*|五月|05月|5月","i"),null!==c.match(g)&&(f=5,c=c.replace(g,"")),g=new RegExp("Jun[A-Za-z]*|六月|06月|6月","i"),null!==c.match(g)&&(f=6,c=c.replace(g,"")),g=new RegExp("Jul[A-Za-z]*|七月|07月|7月","i"),null!==c.match(g)&&(f=7,c=c.replace(g,"")),g=new RegExp("Aug[A-Za-z]*|八月|08月|8月","i"),null!==c.match(g)&&(f=8,c=c.replace(g,"")),g=new RegExp("Sep[A-Za-z]*|九月|09月|9月","i"),null!==c.match(g)&&(f=9,c=c.replace(g,"")),c=c.replace(/日|秒/g," "),c=c.replace(/时|分/g,":");var h=c.match(/ \d+:\d+:\d+/);null==h&&(h=""),c=c.replace(/ \d+:\d+:\d+/,"")+h;var i=new Date,j=0,k=0,l=0,m=0,n=0,o=0,p=c,q="",r=0;MC2=0,MC3=0,q=p.match(/\d+/),null!==q&&(r=parseInt(q[0]),p=p.replace(/\d+/,"")),q=p.match(/\d+/),null!==q&&(MC2=parseInt(q[0]),p=p.replace(/\d+/,"")),0>=f&&(q=p.match(/\d+/),null!==q&&(MC3=parseInt(q[0]),p=p.replace(/\d+/,""))),f>0?(k=f,MC2<=31?(j=r,l=MC2):(j=MC2,l=r)):"dmy"==e?(l=r,k=MC2,j=MC3):"mdy"==e?(k=r,l=MC2,j=MC3):(j=r,k=MC2,l=MC3,MC3>31?(j=MC3,k=r,l=MC2,r>12&&(l=r,k=MC2)):MC2>12&&(j=MC2,k=r));var q=p.match(/\d+/);null!==q&&(m=parseInt(q[0]),p=p.replace(/\d+/,""));var q=p.match(/\d+/);null!==q&&(n=parseInt(q[0]),p=p.replace(/\d+/,""));var q=p.match(/\d+/);if(null!==q&&(o=parseInt(q[0]),p=p.replace(/\d+/,"")),"isvalidformat"==a.toLowerCase())c=j>0&&k>0&&12>=k&&l>0&&31>=l;else{(""+j).length<4&&(j+=2e3),i.setFullYear(j,k-1,l),i.setHours(m),i.setMinutes(n),i.setSeconds(o);var s=i.getDay();if("weekindex"==a.toLowerCase())c=s;else if("floatvalue"==a.toLowerCase())c=i.getTime();else{var t="";switch(s){case 0:t="日";break;case 1:t="一";break;case 2:t="二";break;case 3:t="三";break;case 4:t="四";break;case 5:t="五";break;case 6:t="六"}if(c=a.replace(/dddd/gi,"星期"+t),/(y+)/i.test(c)&&(c=c.replace(RegExp.$1,(j+"").substr(4-RegExp.$1.length))),/(m+:)/i.test(c)&&(c=c.replace(RegExp.$1,("00"+n+":").substr(("00"+n+":").length-RegExp.$1.length))),/(M+)/i.test(c)){var u=(""+k).length>RegExp.$1.length?(""+k).length:RegExp.$1.length;c=c.replace(RegExp.$1,("00"+k).substr(("00"+k).length-u))}if(/(d+)/i.test(c)){var u=(""+l).length>RegExp.$1.length?(""+l).length:RegExp.$1.length;c=c.replace(RegExp.$1,("00"+l).substr(("00"+l).length-u))}/(H+)/i.test(c)&&(c=c.replace(RegExp.$1,("00"+m).substr(("00"+m).length-RegExp.$1.length))),/(n+)/i.test(c)&&(c=c.replace(RegExp.$1,("00"+n).substr(("00"+n).length-RegExp.$1.length))),/(s+)/i.test(c)&&(c=c.replace(RegExp.$1,("00"+o).substr(("00"+o).length-RegExp.$1.length)))}}if(b.On_Return){var v=b.On_Return;b.On_Return(0,c),b.On_Return_Remain||v!==b.On_Return||(b.On_Return=null)}return c}this.blIslocal||a.indexOf("FILE:")<0?(this.PageData.format_type=a,this.PageData.format_value=c,1==this.DoPostDatas("format")&&(this.GetLastResult(!1),d=this.GetTaskID())):alert(this.altMessageNoReadWriteFile)}return this.DoInit(),this.blWorking=!1,d},SET_PRINT_PAPER:function(a,b,c,d,e){return this.PRINT_INITA(a,b,c,d,e)},PRINT_INIT:function(a){return this.PRINT_INITA(null,null,null,null,a)},PRINT_INITA:function(a,b,c,d,e){return(void 0===a||null===a)&&(a=""),(void 0===b||null===b)&&(b=""),(void 0===c||null===c)&&(c=""),(void 0===d||null===d)&&(d=""),(void 0===e||null===e)&&(e=""),this.NoClearAfterPrint=!1,this.DoInit(),this.PageData.top=a,this.PageData.left=b,this.PageData.width=c,this.PageData.height=d,this.PageData.printtask=e,!0},SET_PRINT_MODE:function(a,b){if((void 0===a||null===a)&&(a=""),(void 0===b||null===b)&&(b=""),""===a)return!1;if(a=a.toLowerCase(),this.PageData[a]=b,"noclear_after_print"==a&&(this.NoClearAfterPrint=b),a.indexOf("window_def")>-1||a.indexOf("control_printer")>-1){var c=null;return 1==this.DoPostDatas("onlysetprint")&&(this.GetLastResult(!1),c=this.GetTaskID()),this.DoInit(),this.blWorking=!1,c}},ADD_PRINT_TEXT:function(a,b,c,d,e){return this.AddItemArray(2,a,b,c,d,e)},ADD_PRINT_TEXTA:function(a,b,c,d,e,f){return this.AddItemArray(2,b,c,d,e,f,a)},ADD_PRINT_HTM:function(a,b,c,d,e){return this.AddItemArray(4,a,b,c,d,e)},ADD_PRINT_HTML:function(a,b,c,d,e){return this.AddItemArray(1,a,b,c,d,e)},ADD_PRINT_HTMLA:function(a,b,c,d,e,f){return this.AddItemArray(1,b,c,d,e,f,a)},ADD_PRINT_BARCODE:function(a,b,c,d,e,f){return this.AddItemArray(9,a,b,c,d,f,null,null,null,null,null,null,e)},ADD_PRINT_BARCODEA:function(a,b,c,d,e,f,g){return this.AddItemArray(9,b,c,d,e,g,a,null,null,null,null,null,f)},ADD_PRINT_RECTA:function(a,b,c,d,e,f,g){return this.AddItemArray(3,a,b,c,d,null,null,2,e,f,g,null)},ADD_PRINT_RECT:function(a,b,c,d,e,f){return this.AddItemArray(3,a,b,c,d,null,null,2,e,f,null,null)},ADD_PRINT_ELLIPSEA:function(a,b,c,d,e,f,g){return this.AddItemArray(3,a,b,c,d,null,null,3,e,f,g,null)},ADD_PRINT_ELLIPSE:function(a,b,c,d,e,f){return this.AddItemArray(3,a,b,c,d,null,null,3,e,f,null,null)},ADD_PRINT_SHAPE:function(a,b,c,d,e,f,g,h){return this.AddItemArray(3,b,c,d,e,null,null,a,f,g,h,null)},ADD_PRINT_LINE:function(a,b,c,d,e,f){return this.AddItemArray(3,a,b,c,d,null,null,0,e,f,null,"1")},ADD_PRINT_DNLINE:function(a,b,c,d,e,f){return this.AddItemArray(3,a,b,c,d,null,null,1,e,f,null,null)},ADD_PRINT_DNLINEA:function(a,b,c,d,e,f,g){return this.AddItemArray(3,a,b,c,d,null,null,1,e,f,g,null)},ADD_PRINT_UPLINE:function(a,b,c,d,e,f){return this.AddItemArray(3,a,b,c,d,null,null,0,e,f,null,null)},ADD_PRINT_UPLINEA:function(a,b,c,d,e,f,g){return this.AddItemArray(3,a,b,c,d,null,null,0,e,f,g,null)},ADD_PRINT_TABLE:function(a,b,c,d,e){return this.AddItemArray(6,a,b,c,d,e)},ADD_PRINT_TBURL:function(a,b,c,d,e){return this.AddItemArray(7,a,b,c,d,e)},ADD_PRINT_URL:function(a,b,c,d,e){return this.AddItemArray(5,a,b,c,d,e)},ADD_PRINT_IMAGE:function(a,b,c,d,e){return this.AddItemArray(8,a,b,c,d,e)},ADD_PRINT_CHART:function(a,b,c,d,e,f){return this.AddItemArray(10,a,b,c,d,f,null,null,null,null,null,null,null,e)},SET_PRINT_PROPERTY:function(a,b,c,d){this.SET_PRINT_STYLEA(a,"ItemType",b),this.SET_PRINT_STYLEA(a,"HOrient",c),this.SET_PRINT_STYLEA(a,"VOrient",d)},SET_PRINT_PROPERTYA:function(a,b,c,d){this.SET_PRINT_PROPERTY(a,b,c,d)},SET_PRINT_STYLE:function(a,b){return(void 0===a||null===a)&&(a=""),(void 0===b||null===b)&&(b=""),""===a?!1:(a=a.toLowerCase(),void(this.defStyleJson[a]=b))},SET_PRINT_STYLEA:function(a,b,c){if((void 0===a||null===a)&&(a=""),(void 0===b||null===b)&&(b=""),(void 0===c||null===c)&&(c=""),""===a||""===b)return!1;if(this.ItemDatas.count<=0)return void 0!==this.PageData.add_print_program_data?(this.ItemCNameStyles[b.toLowerCase()+"-"+a]=c,!0):!1;if(b=b.toLowerCase(),"type"==b)return!1;var d=!1;0==a&&(a=this.ItemDatas.count);for(var e in this.ItemDatas){var f=this.ItemDatas[e].itemname;(a==e||a==f||"string"==typeof a&&"string"==typeof f&&a.toUpperCase()==f.toUpperCase())&&(this.ItemDatas[e][b]=c,d=!0)}return d?!0:!1},SET_PRINT_TEXT_STYLE:function(a,b,c,d,e,f,g){this.SET_PRINT_STYLEA(a,"fontname",b),this.SET_PRINT_STYLEA(a,"fontsize",c),this.SET_PRINT_STYLEA(a,"bold",d),this.SET_PRINT_STYLEA(a,"italic",e),this.SET_PRINT_STYLEA(a,"underline",f),this.SET_PRINT_STYLEA(a,"alignment",g)},SET_PRINT_TEXT_STYLEA:function(a,b,c,d,e,f,g,h){this.SET_PRINT_TEXT_STYLE(a,b,c,d,e,f,g),this.SET_PRINT_STYLEA(a,"fontcolor",h)},SET_PRINT_TEXT_STYLEB:function(a,b,c,d,e,f,g,h){this.SET_PRINT_TEXT_STYLEA(a,b,c,d,e,f,g,h)},NEWPAGE:function(){this.NewPage()},NewPage:function(){var a,b=!1;for(var c in this.ItemDatas){a="count"==c?!1:!0;for(var d in this.ItemDatas[c])if("itemtype"==d&&(a=!1,0==this.ItemDatas[c][d]||4==this.ItemDatas[c][d])){b=!0;break}if(a&&(b=!0),b)break}b&&(this.defStyleJson.beginpage=this.defStyleJson.beginpage+1)},NEWPAGEA:function(){this.NewPageA()},NewPageA:function(){var a,b=!1;for(var c in this.ItemDatas){a="count"==c?!1:!0;for(var d in this.ItemDatas[c])if("itemtype"==d&&(a=!1,0==this.ItemDatas[c][d]||4==this.ItemDatas[c][d])){b=!0;break}if(a&&(b=!0),b)break}b&&(this.defStyleJson.beginpagea=this.defStyleJson.beginpagea+1)},PREVIEW:function(a,b,c){if(this.blWorking)return alert(this.altMessageBusy),null;var d=null;return!a&&this.blIslocal?1==this.DoPostDatas("preview")&&(this.Result=null,this.GetLastResult(!0),d=this.GetTaskID()):1==this.DoPostDatas("cpreview")&&(this.DoCPreview(a,b,c),d=this.GetTaskID()),this.DoInit(),this.blWorking=!1,d},PRINT:function(a,b,c){if(this.blWorking)return alert(this.altMessageBusy),null;var d=null;return 1==this.DoPostDatas("print")&&(d=this.GetTaskID()),this.DoInit(),this.blWorking=!1,d},GET_PRINTER_COUNT:function(){return void 0===this.Printers?0:this.Printers.list.length},GET_PRINTER_NAME:function(a){if(void 0===this.Printers)return"";if("string"==typeof a&&a.indexOf(":")>-1){var b=a.slice(a.indexOf(":")+1);return a=a.slice(0,a.indexOf(":")),-1==a?this.Printers.list[this.Printers["default"]][b]:this.Printers.list[a][b]}return-1==a?this.Printers.list[this.Printers["default"]].name:a>=0&&a<this.Printers.list.length?this.Printers.list[a].name:"Printer NO. overflow"},GET_PAGESIZES_LIST:function(a,b,c,d){if(c||(c="pagelist"),d||(d="name"),void 0===this.Printers)return"";-1==a&&(a=this.Printers.list[this.Printers["default"]].name);for(var e in this.Printers.list)if(a==e||a==this.Printers.list[e].name){var f="";for(var g in this.Printers.list[e][c])f="id"==d&&this.Printers.list[e][c][g].id?""===f?this.Printers.list[e][c][g].id:f+b+this.Printers.list[e][c][g].id:""===f?this.Printers.list[e][c][g].name:f+b+this.Printers.list[e][c][g].name;return f}return""},SET_PRINTER_INDEX:function(a,b){if(void 0===this.Printers)return!1;b||(b="printerindex"),a+="",a=a.replace(/^\s+|\s+$/g,"");var c=a.indexOf(","),d=a;if(c>-1&&(d=a.slice(0,c)),"-1"==d)return this.PageData[b]=this.Printers["default"],c>-1&&(this.PageData.printersubid=a.slice(c+1)),!0;for(var e in this.Printers.list){var f=this.Printers.list[e].name;if(f.replace(/\\/g,"")==d.replace(/\\/g,"")||e==d)return this.PageData[b]=e,c>-1&&(this.PageData.printersubid=a.slice(c+1)),!0}return!1},SET_PRINTER_INDEXA:function(a){return this.SET_PRINTER_INDEX(a,"printerindexa")},PRINT_DESIGN:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var a=null;return this.blIslocal?1==this.DoPostDatas("print_design")&&(this.Result=null,this.GetLastResult(!0),a=this.GetTaskID()):alert(this.altMessageNoPrintDesign),this.DoInit(),this.blWorking=!1,a},PRINT_SETUP:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var a=null;return this.blIslocal?1==this.DoPostDatas("print_setup")&&(this.Result=null,this.GetLastResult(!0),a=this.GetTaskID()):alert(this.altMessageNoPrintSetup),this.DoInit(),this.blWorking=!1,a},SET_PRINT_PAGESIZE:function(a,b,c,d){void 0!==a&&null!==a&&(this.PageData.orient=a),void 0!==b&&null!==b&&(this.PageData.pagewidth=b),void 0!==c&&null!==c&&(this.PageData.pageheight=c),void 0!==d&&null!==d&&(this.PageData.pagename=d)},SET_PRINT_COPIES:function(a){return void 0!==a&&null!==a?(this.PageData.printcopies=a,!0):void 0},SELECT_PRINTER:function(a){return this.SelectBox.create(388,240,!a),!0},PRINTA:function(a,b){if(this.blWorking)return alert(this.altMessageBusy),null;var c=null;return!b&&this.blIslocal?(this.Result=null,a?1==this.DoPostDatas("printb")&&(this.GetLastResult(!1),c=this.GetTaskID()):1==this.DoPostDatas("printa")&&(this.GetLastResult(!0),c=this.GetTaskID()),this.DoInit(),this.blWorking=!1):this.SELECT_PRINTER(!0),c},PRINTAOK:function(a,c,d,e,f){if(this.SET_PRINTER_INDEX(a),this.SET_PRINT_COPIES(c),void 0!==d&&0!==d&&this.SET_PRINT_MODE("PRINT_START_PAGE",d),void 0!==e&&0!==e&&this.SET_PRINT_MODE("PRINT_END_PAGE",e),f){if(this.blTmpSelectedIndex=a,b.On_Return){var g=b.On_Return;b.On_Return(0,a),b.On_Return_Remain||g!==b.On_Return||(b.On_Return=null)}}else this.PRINT()},SET_LICENSES:function(a,b,c,d){"THIRD LICENSE"==a&&""==b?(c&&""!==c&&(this.PageDataEx.licensec=c),d&&""!==d&&(this.PageDataEx.licensed=d)):"LICENSE TETCODE"==a&&""==b&&""==d?c&&""!==c&&(this.PageDataEx.Licensetetcode=c):(a&&""!==a&&(this.PageDataEx.companyname=a),b&&""!==b&&(this.PageDataEx.license=b),c&&""!==c&&(this.PageDataEx.licensea=c),d&&""!==d&&(this.PageDataEx.licenseb=d))},PRINTB:function(){return this.PRINTA(!0)},PREVIEWA:function(){return this.PREVIEW()},PREVIEWB:function(){return this.PREVIEW()},ADD_PRINT_SETUP_BKIMG:function(a){return void 0!==a&&null!==a?(this.PageData.setup_bkimg=a,!0):void 0},SET_PREVIEW_WINDOW:function(a,b,c,d,e,f){void 0!==a&&null!==a&&(this.PageData.pvw_dispmode=a),void 0!==b&&null!==b&&(this.PageData.pvw_toolmode=b),void 0!==c&&null!==c&&(this.PageData.pvw_directprint=c),void 0!==d&&null!==d&&(this.PageData.pvw_width=d),void 0!==e&&null!==e&&(this.PageData.pvw_height=e),void 0!==f&&null!==f&&(this.PageData.pvw_puttoncaptoin=f)},SET_PREVIEW_MODE:function(a){void 0!==a&&(this.PageData.pvw_preview_mode=a)},SET_SHOW_MODE:function(a,b){return(void 0===a||null===a)&&(a=""),(void 0===b||null===b)&&(b=""),""===a?!1:(a=a.toLowerCase(),void(this.PageData["shwmod_"+a]=b))},SAVE_TO_FILE:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return this.blIslocal?a&&(this.PageData.stf_file_name=a,1==this.DoPostDatas("savetofile")&&(this.GetLastResult(!1),b=this.GetTaskID())):alert(this.altMessageNoWriteFile),this.DoInit(),this.blWorking=!1,b},SET_SAVE_MODE:function(a,b){return(void 0===a||null===a)&&(a=""),(void 0===b||null===b)&&(b=""),""===a?!1:(a=a.toLowerCase(),void(this.PageData["stfmod_"+a]=b))},SEND_PRINT_RAWDATA:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return void 0!==a&&(this.PageData.raw_print_data=a,1==this.DoPostDatas("sendrawdata")&&(this.GetLastResult(!1),b=this.GetTaskID())),this.DoInit(),this.blWorking=!1,b},WRITE_FILE_TEXT:function(a,b,c){if(this.blWorking)return alert(this.altMessageBusy),null;var d=null;return this.blIslocal?void 0!==b&&void 0!==c&&(this.PageData.write_file_mode=a,this.PageData.write_file_name=b,this.PageData.write_file_text=c,1==this.DoPostDatas("writefiletext")&&(this.GetLastResult(!1),d=this.GetTaskID())):alert(this.altMessageNoWriteFile),this.DoInit(),this.blWorking=!1,d},GET_DIALOG_VALUE:function(a,b){if(this.blWorking)return alert(this.altMessageBusy),null;var c=null;return void 0!==a&&void 0!==b&&(this.blIslocal?(this.PageData.dialog_type=a,this.PageData.dialog_value=b,1==this.DoPostDatas("dialog")&&(this.GetLastResult(!0),c=this.GetTaskID())):alert(this.altMessageNoReadWriteFile)),this.DoInit(),this.blWorking=!1,c},WRITE_PORT_DATA:function(a,b){if(this.blWorking)return alert(this.altMessageBusy),null;var c=null;return void 0!==a&&void 0!==b&&(this.PageData.write_port_name=a,this.PageData.write_port_data=b,1==this.DoPostDatas("writeportdata")&&(this.GetLastResult(!1),c=this.GetTaskID())),this.DoInit(),this.blWorking=!1,c},READ_PORT_DATA:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return void 0!==a&&(this.PageData.read_port_name=a,1==this.DoPostDatas("readportdata")&&(this.GetLastResult(!1),b=this.GetTaskID())),this.DoInit(),this.blWorking=!1,b},GET_SYSTEM_INFO:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return void 0!==a&&(this.PageData.system_info_type=a,1==this.DoPostDatas("getsysteminfo")&&(this.GetLastResult(!1),b=this.GetTaskID())),this.DoInit(),this.blWorking=!1,b},GET_FILE_TEXT:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return this.blIslocal?void 0!==a&&(this.PageData.get_file_name=a,1==this.DoPostDatas("getfiletext")&&(this.GetLastResult(!1),b=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,b},IS_FILE_EXIST:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return this.blIslocal?void 0!==a&&(this.PageData.file_exist_name=a,1==this.DoPostDatas("isfileexist")&&(this.GetLastResult(!1),b=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,b},GET_FILE_TIME:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return this.blIslocal?void 0!==a&&(this.PageData.file_time_name=a,1==this.DoPostDatas("getfiletime")&&(this.GetLastResult(!1),b=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,b},GET_PRINT_INIFFNAME:function(a){if(this.blWorking)return alert(this.altMessageBusy),null;var b=null;return this.blIslocal?void 0!==a&&(this.PageData.iniff_task_name=a,1==this.DoPostDatas("getiniffname")&&(this.GetLastResult(!1),b=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,b},GET_VALUE:function(a,b){if(this.blWorking)return alert(this.altMessageBusy),null;var c=null;return void 0!==a&&void 0!==b&&(this.PageData.get_value_type=a,
this.PageData.get_value_index=b,1==this.DoPostDatas("dogetvalue")&&(this.GetLastResult(!1),c=this.GetTaskID())),this.DoInit(),this.blWorking=!1,c},ADD_PRINT_DATA:function(a,b){return void 0!==a&&null!==b&&a.toLowerCase().indexOf("programdata")>-1?(this.PageData.add_print_program_data=b,!0):void 0},SHOW_CHART:function(){},DO_ACTION:function(a,b){if(this.blWorking)return alert(this.altMessageBusy),null;var c=null;return void 0!==a&&void 0!==b&&(this.PageData.do_action_name=a,this.PageData.do_action_value=b,1==this.DoPostDatas("doaction")&&(this.GetLastResult(!1),c=this.GetTaskID())),this.DoInit(),this.blWorking=!1,c},Create_Printer_List:function(a,b){for(;a.childNodes.length>0;)for(var c=a.childNodes,d=0;d<c.length;d++)a.removeChild(c[d]);for(var e=this.GET_PRINTER_COUNT(),f=0,d=0;e>d;d++){var g=document.createElement("option");if(g.innerHTML=this.GET_PRINTER_NAME(d),g.value=f,a.appendChild(g),f++,this.VERSION_EXT&&this.Printers.list[d].subdevlist.length>0)if(b)g.innerHTML=g.innerHTML+",..";else for(var h=g.innerHTML,i=0;i<this.Printers.list[d].subdevlist.length;i++){var j=this.Printers.list[d].subdevlist[i].id,k=this.Printers.list[d].subdevlist[i].name;if(0==i)g.innerHTML=h+","+k,g.value=h+","+j+";"+k;else if(g=document.createElement("option"),g.innerHTML=h+","+k,g.value=h+","+j+";"+k,a.appendChild(g),f++,f>=100)return}}},Create_PageSize_List:function(a,c){for(;a.childNodes.length>0;)for(var d=a.childNodes,e=0;e<d.length;e++)a.removeChild(d[e]);var f=b.GET_PAGESIZES_LIST(c,"\n"),g=new Array;g=f.split("\n");for(var e in g){var h=document.createElement("option");h.innerHTML=g[e],h.value=g[e],a.appendChild(h)}},AddItemArray:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){if(void 0===b||void 0===c||void 0===d||void 0===e||void 0===f)return!1;var o=this.ItemDatas.count;o++;var p={};for(var q in this.defStyleJson)p[q]=this.defStyleJson[q];return p.type=a,p.top=b,p.left=c,p.width=d,p.height=e,null!=f&&("string"==typeof f&&f.indexOf(this.DelimChar)>-1?p.content=f.replace(new RegExp(this.DelimChar,"g"),""):p.content=f),void 0!==g&&null!=g&&(p.itemname=g+""),void 0!==h&&null!=h&&(p.shapetype=h),void 0!==i&&null!=i&&(p.penstyle=i),void 0!==j&&null!=j&&(p.penwidth=j),void 0!==k&&null!=k&&(p.fontcolor=k),void 0!==l&&null!=l&&(p.lineposition="1"),void 0!==m&&null!=m&&(p.fontname=m),void 0!==n&&null!=n&&(p.charttypess=n),p.beginpage=this.defStyleJson.beginpage,p.beginpagea=this.defStyleJson.beginpagea,this.ItemDatas.count=o,this.ItemDatas[o]=p,this.blNormalItemAdded=!0,!0},RemoveIframes:function(){var a=document.body||document.getElementsByTagName("body")[0]||document.documentElement;try{for(var b=0;b<this.Iframes.length;b++){var c=(new Date).getTime();c-this.Iframes[b].time>6e4*this.timeThreshold&&(a.removeChild(this.Iframes[b].iframe),this.Iframes.splice(b,1))}}catch(d){}},AddInputElement:function(a,b,c,d){if(void 0!==d){var e=a.createElement("input");e.name=c,e.type="hidden",e.value=d,b.appendChild(e)}},createPostDataString:function(a){var b="act="+a+this.DelimChar;b=b+"browseurl="+window.location.href+this.DelimChar;for(var c in this.PageDataEx)b=b+c+"="+this.PageDataEx[c]+this.DelimChar;var d="";for(var c in this.PageData)b=b+c+"="+this.PageData[c]+this.DelimChar,"top"!=c&&"left"!=c&&"width"!=c&&"height"!=c&&"printtask"!=c&&"printerindex"!=c&&"printerindexa"!=c&&"printersubid"!=c&&"orient"!=c&&"pagewidth"!=c&&"pageheight"!=c&&"pagename"!=c&&"printcopies"!=c&&"setup_bkimg"!=c&&(d=d+";"+c);""!==d&&(b=b+"printmodenames="+d+this.DelimChar);var e="";for(var f in this.ItemCNameStyles)b=b+f+"="+this.ItemCNameStyles[f]+this.DelimChar,e=e+";"+f;""!==e&&(b=b+"printstyleclassnames="+e+this.DelimChar),b=b+"itemcount="+this.ItemDatas.count+this.DelimChar;for(var g in this.ItemDatas){var h="";for(var i in this.ItemDatas[g])"beginpage"!=i&&"beginpagea"!=i&&"type"!=i&&"top"!=i&&"left"!=i&&"width"!=i&&"height"!=i&&(h=h+";"+i);b=b+g+"_itemstylenames="+h+this.DelimChar;for(var i in this.ItemDatas[g])b=b+g+"_"+i+"="+this.ItemDatas[g][i]+this.DelimChar}return b},wsDoPostDatas:function(a){var b="charset=丂"+this.DelimChar;return b=b+"tid="+this.GetTaskID()+this.DelimChar,b+=this.createPostDataString(a),this.wsSend("post:"+b)},DoPostDatas:function(a){if(1==this.blOneByone)return alert(this.altMessageSomeWindowExist),!1;if(this.blWorking=!0,null!==this.blTmpSelectedIndex&&this.SET_PRINTER_INDEX(this.blTmpSelectedIndex),this.SocketEnable)return this.wsDoPostDatas(a);this.RemoveIframes();var b=document.body||document.getElementsByTagName("body")[0]||document.documentElement,c=document.createElement("iframe");c.setAttribute("src","about:blank"),c.setAttribute("style","display:none"),c.height=0,b.appendChild(c);var d=c.contentWindow.document;d.write("<form action='"+this.strHostURI+"/c_dopostdatas' method='post' enctype='application/x-www-form-urlencoded'></form>");var e=d.getElementsByTagName("form")[0];this.AddInputElement(d,e,"charset","丂"),this.AddInputElement(d,e,"tid",this.GetTaskID()),this.AddInputElement(d,e,"post",this.createPostDataString(a)),e.submit();var f={};return f.time=(new Date).getTime(),f.iframe=c,this.Iframes.push(f),!0},GetLastResult:function(a){if(a&&(this.blOneByone=!0),this.SocketEnable)return!0;var c=this.strHostURI+"/c_lastresult.js";c=c+"?times="+(new Date).getTime(),c=c+"&tid="+this.GetTaskID(),c=encodeURI(c).replace("%20","+");var d=document.createElement("script");d.src=c,d.async=!1,d.type="text/javascript",d.charset="utf-8";var e=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return e.insertBefore(d,e.firstChild),d.onload=d.onreadystatechange=function(){if(!d.readyState||/loaded|complete/.test(d.readyState)){if(b.blOneByone=!1,CLodop_ACTLastResult)var a=decodeURIComponent(CLodop_ACTLastResult);var c=CLodop_ACTTaskID;if(b.Result=a,CLodop_ACTAlert&&CLodop_ACTAlert(),b.On_Return)try{var e=b.On_Return;"true"==a||"false"==a?b.On_Return(c,"true"==a):b.On_Return(c,a),b.On_Return_Remain||e!==b.On_Return||(b.On_Return=null)}catch(f){}d.onload=d.onreadystatechange=null,d.parentNode&&d.parentNode.removeChild(d)}},!0},DoCPreview:function(a,b,c){var d=document.body||document.getElementsByTagName("body")[0]||document.documentElement;"number"!=typeof b?b=Math.round(2*d.offsetWidth/3):d.offsetWidth<b&&(b=d.offsetWidth),"number"!=typeof c?c=Math.round(window.screen.height-200):window.screen.height<c&&(c=window.screen.height);var e=this.strHostURI+"/c_dopreview";e=e+"?times="+(new Date).getTime(),e=e+"&tid="+this.GetTaskID(),e=e+"&iw="+b,e=e+"&ih="+c,e=encodeURI(e).replace("%20","+"),this.PopView(a,e,b,c)},PopView:function(a,b,c,d){try{if(a&&"string"==typeof a&&a.length>0)if("_dialog"===a)window.showModalDialog?window.showModalDialog(b,"dialog","center:yes"):window.open(b,"","scrollbars=yes,toolbar=no,left=150,top=100,resizable=yes");else if("_self"===a||"_top"===a||"_parent"===a)window.location.href=b;else if("_blank"===a)this.PreviewBox.create(b,c,d);else if(a.indexOf("_winopen:")>-1){var e=a.slice(a.indexOf("_winopen:")+9);e.indexOf("_blank")>-1?window.open(b,"_blank",e.slice(e.indexOf("_blank")+6)):window.open(b,"",e)}else document.getElementById(a)?document.getElementById(a).src=b:alert("iframe '"+a+"' not exist!");else this.PreviewBox.create(b,c,d)}catch(f){alert("CLODOP PopView "+f)}},creatMyButtonElement:function(a,b){try{var c=document.createElement("<input type='"+a+"' value='"+b+"'></input>")}catch(d){}return c||(c=document.createElement("input"),c.type=a,c.value=b),c},creatLabelElement:function(a,b,c,d,e){var f=document.createElement(a);return f.innerHTML=b,f.style.cssText="position:absolute;width:"+c+"px;left:"+d+"px;top:"+e+"px;",f},SelectBox:{dragapproved:!1,offsetx:0,offsety:0,tempx:0,tempy:0,FrantDiv:void 0,PopDiv:void 0,selPrinter:void 0,selCopies:void 0,closeit:function(){b.SelectBox.PopDiv&&b.SelectBox.PopDiv.parentNode&&b.SelectBox.PopDiv.parentNode.removeChild(b.SelectBox.PopDiv),this.FrantDiv&&this.FrantDiv.parentNode&&this.FrantDiv.parentNode.removeChild(this.FrantDiv),this.PopDiv=void 0},initializedrag:function(a){var b=window.event||a;this.offsetx=b.clientX,this.offsety=b.clientY,this.tempx=parseInt(this.PopDiv.style.left),this.tempy=parseInt(this.PopDiv.style.top),this.dragapproved=!0},drag_drop:function(a){if(this.dragapproved){var b=window.event||a;this.PopDiv.style.left=b.clientX-this.offsetx+this.tempx+"px",this.PopDiv.style.top=b.clientY-this.offsety+this.tempy+"px"}},stopdrag:function(){this.dragapproved=!1},clickOK:function(a){b.PRINTAOK(b.SelectBox.selPrinter.value,b.SelectBox.selCopies.value,0,0,a),this.closeit()},create:function(a,c,d){b.SelectBox.PopDiv&&this.closeit();var e=document.body||document.getElementsByTagName("body")[0]||document.documentElement,f=document.createElement("div");e.appendChild(f),f.style.cssText="position:absolute;z-index:91100;display:block;top:2px;border:1px solid #6B97C1;background:#F5F5F5;color:#000;font-size:13px;",f.style.width=a+"px",f.style.left=Math.max((e.offsetWidth-a)/2,0)+"px",f.style.top=Math.max((e.offsetHeight-c)/2,0)+"px",f.style.height=c+"px",this.PopDiv=f;var g=document.createElement("div");f.appendChild(g),g.style.cssText="font: bold 13px Arial;line-height:25px;height:27px;text-indent:5px;color: white;background:#8BACCF",g.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打印",g.onmousedown=function(a){b.SelectBox.initializedrag(a)},g.onmousemove=function(a){b.SelectBox.drag_drop(a)},g.onmouseup=function(){b.SelectBox.stopdrag()};var h=document.createElement("button");g.appendChild(h),h.style.cssText="background:transparent url("+b.strHostURI+"/c_favicon.ico) no-repeat scroll 0 0px;margin-left:5px;position:absolute;height:20px;line-height:100px;width:34px;left:3px;border:0;top:5px";var i=document.createElement("button");g.appendChild(i),i.style.cssText="background:transparent url("+b.strHostURI+"/images/c_winclose.png) no-repeat scroll 0 0px;margin-right:5px;position:absolute;height:20px;line-height:100px;width:34px;right:3px;border:0;top:4px",i.onclick=function(){if(b.SelectBox.closeit(),d&&b.On_Return){var a=b.On_Return;b.On_Return(0,-1),b.On_Return_Remain||a!==b.On_Return||(b.On_Return=null)}};var j=document.createElement("div");f.appendChild(j),j.style.cssText="background:#F5F5F5;color:#000;border:0px;left:0px;top:0px;",j.style.width=a-2+"px",j.style.height=c-27+"px";var k=b.creatMyButtonElement("button","确定");f.appendChild(k),k.style.cssText="position:absolute;width:80px;height:23px;",k.style.left="110px",k.style.top=c-64+"px",k.onclick=function(){b.SelectBox.clickOK(d)};var l=b.creatMyButtonElement("button","取消");f.appendChild(l),l.style.cssText="position:absolute;width:80px;;height:23px;",l.style.left="240px",l.style.top=c-64+"px",l.onclick=function(){if(b.SelectBox.closeit(),d&&b.On_Return){var a=b.On_Return;b.On_Return(0,-1),b.On_Return_Remain||a!==b.On_Return||(b.On_Return=null)}},j.appendChild(b.creatLabelElement("span","选打印机：",200,46,67));var m=document.createElement("select");f.appendChild(m),this.selPrinter=m,m.style.cssText="position:absolute;size:1;width:212px;left:110px;top:62px;",b.Create_Printer_List(m),j.appendChild(b.creatLabelElement("span","打印份数：",200,46,121));var n=b.creatMyButtonElement("text","1");f.appendChild(n),this.selCopies=n,n.style.cssText="position:absolute;size:1;width:30px;left:110px;top:117px;",this.FrantDiv=document.createElement("div"),e.appendChild(this.FrantDiv),this.FrantDiv.style.cssText="border:0px;left:0px;top:0px;filter: alpha(opacity=20); position: fixed; opacity: 0.2;-moz-opacity: 0.2; _position: absolute;z-index:91009; over-flow: hidden;",b.Browser.IE&&("BackCompat"==document.compatMode||navigator.userAgent.indexOf("MSIE 6.0")>0)?(this.FrantDiv.style.width=e.scrollWidth+"px",this.FrantDiv.style.height=e.scrollHeight+"px"):(this.FrantDiv.style.width="100%",this.FrantDiv.style.height="100%")}},PreviewBox:{dragapproved:!1,offsetx:0,offsety:0,tempx:0,tempy:0,FrantDiv:void 0,PopDiv:void 0,ContentFrame:void 0,closeit:function(a){b.PreviewBox.PopDiv&&b.PreviewBox.PopDiv.parentNode&&b.PreviewBox.PopDiv.parentNode.removeChild(b.PreviewBox.PopDiv),this.FrantDiv&&this.FrantDiv.parentNode&&this.FrantDiv.parentNode.removeChild(this.FrantDiv),this.PopDiv=void 0},initializedrag:function(a,b){var c=window.event||a;this.offsetx=c.clientX,this.offsety=c.clientY,this.tempx=parseInt(b.style.left),this.tempy=parseInt(b.style.top),this.dragapproved=!0},drag_drop:function(a,b){if(this.dragapproved){var c=window.event||a;b.style.left=c.clientX-this.offsetx+this.tempx+"px",b.style.top=c.clientY-this.offsety+this.tempy+"px"}},stopdrag:function(){this.dragapproved=!1,this.ContentFrame&&(this.ContentFrame.style.display="block")},create:function(a,c,d){b.PreviewBox.PopDiv&&this.closeit();var e=document.body||document.getElementsByTagName("body")[0]||document.documentElement,f=document.createElement("div");e.appendChild(f),f.style.cssText="position:absolute;z-index:91100;display:block;top:2px;border:1px solid #6B97C1;font-size:13px;",f.style.width=c+"px";var g=(e.offsetWidth-c)/2;window.screen.width<e.offsetWidth&&(g=(window.screen.width-c)/2),0>g&&(g=0),f.style.left=g+"px",f.style.height=d+"px",f.onmousedown=function(a){b.PreviewBox.initializedrag(a,this)},f.onmouseup=function(){b.PreviewBox.stopdrag()},f.onmousemove=function(a){b.PreviewBox.drag_drop(a,this)},this.PopDiv=f;var h=document.createElement("div");f.appendChild(h),h.style.cssText="position:absolute;left:0px;width:100%;font: bold 14px Arial;line-height:27px;height:27px;text-indent:26px;color: white;background:#8BACCF",h.innerHTML="打印预览";var i=document.createElement("button");h.appendChild(i),i.style.cssText="background:transparent url("+b.strHostURI+"/c_favicon.ico) no-repeat scroll 0 0px;margin-left:5px;position:absolute;height:20px;line-height:100px;width:34px;left:3px;border:0;top:5px";var j=document.createElement("button");h.appendChild(j),j.style.cssText="background:transparent url("+b.strHostURI+"/images/c_winclose.png) no-repeat scroll 0 0px;margin-right:5px;position:absolute;height:20px;line-height:100px;width:34px;right:3px;border:0;top:4px",j.onclick=function(){b.PreviewBox.closeit(this)};var k=document.createElement("div");f.appendChild(k),k.style.cssText="background:#F5F5F5;color:#000;border:0px;left:0px;top:0px;",k.style.width=c+"px",k.style.height=d-0+"px",this.ContentFrame=document.createElement("iframe"),k.appendChild(this.ContentFrame),this.ContentFrame.style.cssText="width:100%;height:100%;",this.ContentFrame.src=a,this.ContentFrame.frameBorder="no",this.FrantDiv=document.createElement("div"),e.appendChild(this.FrantDiv),this.FrantDiv.style.cssText="border:0px;left:0px;top:0px;filter: alpha(opacity=20); position: fixed; opacity: 0.2; -moz-opacity: 0.2; _position: absolute;z-index:91009; over-flow: hidden;",b.Browser.IE&&("BackCompat"==document.compatMode||navigator.userAgent.indexOf("MSIE 6.0")>0)?(this.FrantDiv.style.width=e.scrollWidth+"px",this.FrantDiv.style.height=e.scrollHeight+"px"):(this.FrantDiv.style.width="100%",this.FrantDiv.style.height="100%")}}};return a.CLODOP2015_7028&&a.CLODOP2015_7028.Priority&&a.CLODOP2015_7028.Priority>b.Priority?(b=a.CLODOP2015_7028,void(a.CLODOP_OK_Priority=a.CLODOP2015_7028.Priority)):(a.LODOP=b,a.CLODOP=b,a.CLODOP2015_7028=b,a.CLODOP_OK_Priority=b.Priority,a.CLODOP.DoInit(),void(navigator.userAgent.indexOf("Lodop")<0&&a.CLODOP.OpenWebSocket()))}(window);