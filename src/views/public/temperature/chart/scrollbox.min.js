"use strict";var _createClass=function(){function r(t,o){for(var i=0;i<o.length;i++){var r=o[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,o,i){return o&&r(t.prototype,o),i&&r(t,i),t}}();function _classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,o){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?t:o}function _inherits(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);t.prototype=Object.create(o&&o.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(t,o):t.__proto__=o)}var Viewport=require("pixi-viewport"),defaults=require("./defaults"),DEFAULTS=require("./defaults.json"),Scrollbox=function(t){function i(t){_classCallCheck(this,i);var o=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return o.options=defaults(t,DEFAULTS),o.content=o.addChild(new Viewport({screenWidth:o.boxWidth,screenHeight:o.boxHeight})),o.content.decelerate().on("moved",function(){return o._drawScrollbars()}),o.options.dragScroll&&o.content.drag({clampWheel:!0}),o.scrollbar=o.addChild(new PIXI.Graphics),o.scrollbar.interactive=!0,o.scrollbar.on("pointerdown",o.scrollbarDown,o),o.interactive=!0,o.on("pointermove",o.scrollbarMove,o),o.on("pointerup",o.scrollbarUp,o),o.on("pointercancel",o.scrollbarUp,o),o.on("pointerupoutside",o.scrollbarUp,o),o._maskContent=o.addChild(new PIXI.Graphics),o}return _inherits(i,PIXI.Container),_createClass(i,[{key:"_drawScrollbars",value:function(){this._isScrollbarHorizontal="scroll"===this.overflowX||"hidden"!==this.overflowX&&this.content.width>this.options.boxWidth,this._isScrollbarVertical="scroll"===this.overflowY||"hidden"!==this.overflowY&&this.content.height>this.options.boxHeight,this.scrollbar.clear();var t={left:0};t.right=this.content.width+(this._isScrollbarVertical?this.options.scrollbarSize:0),t.top=0,t.bottom=this.content.height+(this.isScrollbarHorizontal?this.options.scrollbarSize:0);var o=this.content.width+(this.isScrollbarVertical?this.options.scrollbarSize:0),i=this.content.height+(this.isScrollbarHorizontal?this.options.scrollbarSize:0);this.scrollbarTop=this.content.top/i*this.boxHeight,this.scrollbarHeight=this.boxHeight/i*this.boxHeight,this.scrollbarLeft=this.content.left/o*this.boxWidth,this.scrollbarWidth=this.boxWidth/o*this.boxWidth,this.isScrollbarVertical&&this.scrollbar.beginFill(this.options.scrollbarBackground).drawRect(this.boxWidth-this.scrollbarSize,0,this.scrollbarSize,this.boxHeight).endFill(),this.isScrollbarHorizontal&&this.scrollbar.beginFill(this.options.scrollbarBackground).drawRect(0,this.boxHeight-this.scrollbarSize,this.boxWidth,this.scrollbarSize).endFill(),this.isScrollbarVertical&&this.scrollbar.beginFill(this.options.scrollbarForeground).drawRect(this.boxWidth-this.scrollbarSize,this.scrollbarTop,this.scrollbarSize,this.scrollbarHeight).endFill(),this.isScrollbarHorizontal&&this.scrollbar.beginFill(this.options.scrollbarForeground).drawRect(this.scrollbarLeft,this.boxHeight-this.scrollbarSize,this.scrollbarWidth,this.scrollbarSize).endFill(),this.content.clamp(t)}},{key:"_drawMask",value:function(){this._maskContent.beginFill(0).drawRect(0,0,this.boxWidth,this.boxHeight).endFill(),this.mask=this._maskContent}},{key:"update",value:function(){this.mask=null,this._maskContent.clear(),this._drawScrollbars(),this._drawMask()}},{key:"scrollbarDown",value:function(t){var o=this.toLocal(t.data.global);return this.isScrollbarHorizontal&&o.y>this.boxHeight-this.scrollbarSize?(o.x>=this.scrollbarLeft&&o.x<=this.scrollbarLeft+this.scrollbarWidth?this.pointerDown={type:"horizontal",last:o}:(o.x>this.scrollbarLeft?this.content.left+=this.content.worldScreenWidth:this.content.left-=this.content.worldScreenWidth,this.update()),void t.stopPropagation()):this.isScrollbarVertical&&o.x>this.boxWidth-this.scrollbarSize?(o.y>=this.scrollbarTop&&o.y<=this.scrollbarTop+this.scrollbarWidth?this.pointerDown={type:"vertical",last:o}:(o.y>this.scrollbarTop?this.content.top+=this.content.worldScreenHeight:this.content.top-=this.content.worldScreenHeight,this.update()),void t.stopPropagation()):void 0}},{key:"scrollbarMove",value:function(t){if(this.pointerDown){if("horizontal"===this.pointerDown.type){var o=this.toLocal(t.data.global);this.content.left+=o.x-this.pointerDown.last.x,this.pointerDown.last=o,this.update()}else if("vertical"===this.pointerDown.type){var i=this.toLocal(t.data.global);this.content.top+=i.y-this.pointerDown.last.y,this.pointerDown.last=i,this.update()}t.stopPropagation()}}},{key:"scrollbarUp",value:function(){this.pointerDown=null}},{key:"dragScroll",get:function(){return this.options.dragScroll},set:function(t){(this.options.dragScroll=t)?this.content.drag():this.content.removePlugin("drag"),this.update()}},{key:"boxWidth",get:function(){return this.options.boxWidth},set:function(t){this.options.boxWidth=t,this.content.screenWidth=t,this.update()}},{key:"overflow",get:function(){return this.options.overflow},set:function(t){this.options.overflow=t,this.options.overflowX=t,this.options.overflowY=t,this.update()}},{key:"overflowX",get:function(){return this.options.overflowX},set:function(t){this.options.overflowX=t,this.update()}},{key:"overflowY",get:function(){return this.options.overflowY},set:function(t){this.options.overflowY=t,this.update()}},{key:"boxHeight",get:function(){return this.options.boxHeight},set:function(t){this.options.boxHeight=t,this.content.screenHeight=t,this.update()}},{key:"scrollbarSize",get:function(){return this.options.scrollbarSize},set:function(t){this.options.scrollbarSize=t}},{key:"contentWidth",get:function(){return this.options.boxWidth-(this.isScrollbarVertical?this.options.scrollbarSize:0)}},{key:"contentHeight",get:function(){return this.options.boxHeight-(this.isScrollbarHorizontal?this.options.scrollbarSize:0)}},{key:"isScrollbarVertical",get:function(){return this._isScrollbarVertical}},{key:"isScrollbarHorizontal",get:function(){return this._isScrollbarHorizontal}},{key:"scrollTop",get:function(){return this.content.top}},{key:"scrollLeft",get:function(){return this.content.left}},{key:"scrollWidth",get:function(){return this.content.width}},{key:"scrollHeight",get:function(){return this.content.height}}]),i}();PIXI.extras.Scrollbox=Scrollbox,module.exports=Scrollbox;