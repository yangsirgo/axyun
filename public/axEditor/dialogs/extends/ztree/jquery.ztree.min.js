/* 
 * 安想智慧医疗--电子病历编辑器 
 * author jianhui jia 
 * createtime 2019-05-28 15:56:53 
 * updatetime 2019-09-12 04:43:30 
 * version 1.0.0 
 */
!function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{isParent:"isParent",children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",headers:{},xhrFields:{},url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(a){var b=data.getRoot(a);b||(b={},data.setRoot(a,b)),data.nodeChildren(a,b,[]),b.expandTriggerFlag=!1,b.curSelectedList=[],b.noSelection=!0,b.createdNodes=[],b.zId=0,b._ver=(new Date).getTime()},_initCache=function(a){var b=data.getCache(a);b||(b={},data.setCache(a,b)),b.nodes=[],b.doms=[]},_bindEvent=function(a){var b=a.treeObj,c=consts.event;b.bind(c.NODECREATED,function(b,c,d){tools.apply(a.callback.onNodeCreated,[b,c,d])}),b.bind(c.CLICK,function(b,c,d,e,f){tools.apply(a.callback.onClick,[c,d,e,f])}),b.bind(c.EXPAND,function(b,c,d){tools.apply(a.callback.onExpand,[b,c,d])}),b.bind(c.COLLAPSE,function(b,c,d){tools.apply(a.callback.onCollapse,[b,c,d])}),b.bind(c.ASYNC_SUCCESS,function(b,c,d,e){tools.apply(a.callback.onAsyncSuccess,[b,c,d,e])}),b.bind(c.ASYNC_ERROR,function(b,c,d,e,f,g){tools.apply(a.callback.onAsyncError,[b,c,d,e,f,g])}),b.bind(c.REMOVE,function(b,c,d){tools.apply(a.callback.onRemove,[b,c,d])}),b.bind(c.SELECTED,function(b,c,d){tools.apply(a.callback.onSelected,[c,d])}),b.bind(c.UNSELECTED,function(b,c,d){tools.apply(a.callback.onUnSelected,[c,d])})},_unbindEvent=function(a){var b=a.treeObj,c=consts.event;b.unbind(c.NODECREATED).unbind(c.CLICK).unbind(c.EXPAND).unbind(c.COLLAPSE).unbind(c.ASYNC_SUCCESS).unbind(c.ASYNC_ERROR).unbind(c.REMOVE).unbind(c.SELECTED).unbind(c.UNSELECTED)},_eventProxy=function(a){var b=a.target,c=data.getSetting(a.data.treeId),d="",e=null,f="",g="",h=null,i=null,j=null;if(tools.eqs(a.type,"mousedown")?g="mousedown":tools.eqs(a.type,"mouseup")?g="mouseup":tools.eqs(a.type,"contextmenu")?g="contextmenu":tools.eqs(a.type,"click")?tools.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+consts.id.SWITCH)?(d=tools.getNodeMainDom(b).id,f="switchNode"):(j=tools.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),j&&(d=tools.getNodeMainDom(j).id,f="clickNode")):tools.eqs(a.type,"dblclick")&&(g="dblclick",j=tools.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),j&&(d=tools.getNodeMainDom(j).id,f="switchNode")),g.length>0&&0==d.length&&(j=tools.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),j&&(d=tools.getNodeMainDom(j).id)),d.length>0)switch(e=data.getNodeCache(c,d),f){case"switchNode":var k=data.nodeIsParent(c,e);k&&(tools.eqs(a.type,"click")||tools.eqs(a.type,"dblclick")&&tools.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand))?h=handler.onSwitchNode:f="";break;case"clickNode":h=handler.onClickNode}switch(g){case"mousedown":i=handler.onZTreeMousedown;break;case"mouseup":i=handler.onZTreeMouseup;break;case"dblclick":i=handler.onZTreeDblclick;break;case"contextmenu":i=handler.onZTreeContextmenu}var l={stop:!1,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return l},_initNode=function(a,b,c,d,e,f,g){if(c){var h=data.getRoot(a),i=data.nodeChildren(a,c);c.level=b,c.tId=a.treeId+"_"+ ++h.zId,c.parentTId=d?d.tId:null,c.open="string"==typeof c.open?tools.eqs(c.open,"true"):!!c.open;var j=data.nodeIsParent(a,c);tools.isArray(i)?(data.nodeIsParent(a,c,!0),c.zAsync=!0):(j=data.nodeIsParent(a,c,j),c.open=j&&!a.async.enable?c.open:!1,c.zAsync=!j),c.isFirstNode=e,c.isLastNode=f,c.getParentNode=function(){return data.getNodeCache(a,c.parentTId)},c.getPreNode=function(){return data.getPreNode(a,c)},c.getNextNode=function(){return data.getNextNode(a,c)},c.getIndex=function(){return data.getNodeIndex(a,c)},c.getPath=function(){return data.getNodePath(a,c)},c.isAjaxing=!1,data.fixPIdKeyValue(a,c)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(a,b){data.getCache(a).nodes[data.getNodeCacheId(b.tId)]=b},getNodeCacheId:function(a){return a.substring(a.lastIndexOf("_")+1)},addAfterA:function(a){_init.afterA.push(a)},addBeforeA:function(a){_init.beforeA.push(a)},addInnerAfterA:function(a){_init.innerAfterA.push(a)},addInnerBeforeA:function(a){_init.innerBeforeA.push(a)},addInitBind:function(a){_init.bind.push(a)},addInitUnBind:function(a){_init.unbind.push(a)},addInitCache:function(a){_init.caches.push(a)},addInitNode:function(a){_init.nodes.push(a)},addInitProxy:function(a,b){b?_init.proxys.splice(0,0,a):_init.proxys.push(a)},addInitRoot:function(a){_init.roots.push(a)},addNodesData:function(a,b,c,d){var e,f=data.nodeChildren(a,b);f?c>=f.length&&(c=-1):(f=data.nodeChildren(a,b,[]),c=-1),f.length>0&&0===c?(f[0].isFirstNode=!1,view.setNodeLineIcos(a,f[0])):f.length>0&&0>c&&(f[f.length-1].isLastNode=!1,view.setNodeLineIcos(a,f[f.length-1])),data.nodeIsParent(a,b,!0),0>c?data.nodeChildren(a,b,f.concat(d)):(e=[c,0].concat(d),f.splice.apply(f,e))},addSelectedNode:function(a,b){var c=data.getRoot(a);data.isSelectedNode(a,b)||c.curSelectedList.push(b)},addCreatedNode:function(a,b){if(a.callback.onNodeCreated||a.view.addDiyDom){var c=data.getRoot(a);c.createdNodes.push(b)}},addZTreeTools:function(a){_init.zTreeTools.push(a)},exSetting:function(a){$.extend(!0,_setting,a)},fixPIdKeyValue:function(a,b){a.data.simpleData.enable&&(b[a.data.simpleData.pIdKey]=b.parentTId?b.getParentNode()[a.data.simpleData.idKey]:a.data.simpleData.rootPId)},getAfterA:function(a,b,c){for(var d=0,e=_init.afterA.length;e>d;d++)_init.afterA[d].apply(this,arguments)},getBeforeA:function(a,b,c){for(var d=0,e=_init.beforeA.length;e>d;d++)_init.beforeA[d].apply(this,arguments)},getInnerAfterA:function(a,b,c){for(var d=0,e=_init.innerAfterA.length;e>d;d++)_init.innerAfterA[d].apply(this,arguments)},getInnerBeforeA:function(a,b,c){for(var d=0,e=_init.innerBeforeA.length;e>d;d++)_init.innerBeforeA[d].apply(this,arguments)},getCache:function(a){return caches[a.treeId]},getNodeIndex:function(a,b){if(!b)return null;for(var c=b.parentTId?b.getParentNode():data.getRoot(a),d=data.nodeChildren(a,c),e=0,f=d.length-1;f>=e;e++)if(d[e]===b)return e;return-1},getNextNode:function(a,b){if(!b)return null;for(var c=b.parentTId?b.getParentNode():data.getRoot(a),d=data.nodeChildren(a,c),e=0,f=d.length-1;f>=e;e++)if(d[e]===b)return e==f?null:d[e+1];return null},getNodeByParam:function(a,b,c,d){if(!b||!c)return null;for(var e=0,f=b.length;f>e;e++){var g=b[e];if(g[c]==d)return b[e];var h=data.nodeChildren(a,g),i=data.getNodeByParam(a,h,c,d);if(i)return i}return null},getNodeCache:function(a,b){if(!b)return null;var c=caches[a.treeId].nodes[data.getNodeCacheId(b)];return c?c:null},getNodePath:function(a,b){if(!b)return null;var c;return c=b.parentTId?b.getParentNode().getPath():[],c&&c.push(b),c},getNodes:function(a){return data.nodeChildren(a,data.getRoot(a))},getNodesByParam:function(a,b,c,d){if(!b||!c)return[];for(var e=[],f=0,g=b.length;g>f;f++){var h=b[f];h[c]==d&&e.push(h);var i=data.nodeChildren(a,h);e=e.concat(data.getNodesByParam(a,i,c,d))}return e},getNodesByParamFuzzy:function(a,b,c,d){if(!b||!c)return[];var e=[];d=d.toLowerCase();for(var f=0,g=b.length;g>f;f++){var h=b[f];"string"==typeof h[c]&&b[f][c].toLowerCase().indexOf(d)>-1&&e.push(h);var i=data.nodeChildren(a,h);e=e.concat(data.getNodesByParamFuzzy(a,i,c,d))}return e},getNodesByFilter:function(a,b,c,d,e){if(!b)return d?null:[];for(var f=d?null:[],g=0,h=b.length;h>g;g++){var i=b[g];if(tools.apply(c,[i,e],!1)){if(d)return i;f.push(i)}var j=data.nodeChildren(a,i),k=data.getNodesByFilter(a,j,c,d,e);if(d&&k)return k;f=d?k:f.concat(k)}return f},getPreNode:function(a,b){if(!b)return null;for(var c=b.parentTId?b.getParentNode():data.getRoot(a),d=data.nodeChildren(a,c),e=0,f=d.length;f>e;e++)if(d[e]===b)return 0==e?null:d[e-1];return null},getRoot:function(a){return a?roots[a.treeId]:null},getRoots:function(){return roots},getSetting:function(a){return settings[a]},getSettings:function(){return settings},getZTreeTools:function(a){var b=this.getRoot(this.getSetting(a));return b?b.treeTools:null},initCache:function(a){for(var b=0,c=_init.caches.length;c>b;b++)_init.caches[b].apply(this,arguments)},initNode:function(a,b,c,d,e,f){for(var g=0,h=_init.nodes.length;h>g;g++)_init.nodes[g].apply(this,arguments)},initRoot:function(a){for(var b=0,c=_init.roots.length;c>b;b++)_init.roots[b].apply(this,arguments)},isSelectedNode:function(a,b){for(var c=data.getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)if(b===c.curSelectedList[d])return!0;return!1},nodeChildren:function(a,b,c){if(!b)return null;var d=a.data.key.children;return"undefined"!=typeof c&&(b[d]=c),b[d]},nodeIsParent:function(a,b,c){if(!b)return!1;var d=a.data.key.isParent;return"undefined"!=typeof c?("string"==typeof c&&(c=tools.eqs(c,"true")),c=!!c,b[d]=c):"string"==typeof b[d]?b[d]=tools.eqs(b[d],"true"):b[d]=!!b[d],b[d]},nodeName:function(a,b,c){var d=a.data.key.name;return"undefined"!=typeof c&&(b[d]=c),""+b[d]},nodeTitle:function(a,b){var c=""===a.data.key.title?a.data.key.name:a.data.key.title;return""+b[c]},removeNodeCache:function(a,b){var c=data.nodeChildren(a,b);if(c)for(var d=0,e=c.length;e>d;d++)data.removeNodeCache(a,c[d]);data.getCache(a).nodes[data.getNodeCacheId(b.tId)]=null},removeSelectedNode:function(a,b){for(var c=data.getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)b!==c.curSelectedList[d]&&data.getNodeCache(a,c.curSelectedList[d].tId)||(c.curSelectedList.splice(d,1),a.treeObj.trigger(consts.event.UNSELECTED,[a.treeId,b]),d--,e--)},setCache:function(a,b){caches[a.treeId]=b},setRoot:function(a,b){roots[a.treeId]=b},setZTreeTools:function(a,b){for(var c=0,d=_init.zTreeTools.length;d>c;c++)_init.zTreeTools[c].apply(this,arguments)},transformToArrayFormat:function(a,b){function c(b){d.push(b);var c=data.nodeChildren(a,b);c&&(d=d.concat(data.transformToArrayFormat(a,c)))}if(!b)return[];var d=[];if(tools.isArray(b))for(var e=0,f=b.length;f>e;e++){var g=b[e];c(g)}else c(b);return d},transformTozTreeFormat:function(a,b){var c,d,e=a.data.simpleData.idKey,f=a.data.simpleData.pIdKey;if(!e||""==e||!b)return[];if(tools.isArray(b)){var g=[],h={};for(c=0,d=b.length;d>c;c++)h[b[c][e]]=b[c];for(c=0,d=b.length;d>c;c++){var i=h[b[c][f]];if(i&&b[c][e]!=b[c][f]){var j=data.nodeChildren(a,i);j||(j=data.nodeChildren(a,i,[])),j.push(b[c])}else g.push(b[c])}return g}return[b]}},event={bindEvent:function(a){for(var b=0,c=_init.bind.length;c>b;b++)_init.bind[b].apply(this,arguments)},unbindEvent:function(a){for(var b=0,c=_init.unbind.length;c>b;b++)_init.unbind[b].apply(this,arguments)},bindTree:function(a){var b={treeId:a.treeId},c=a.treeObj;a.view.txtSelectedEnable||c.bind("selectstart",handler.onSelectStart).css({"-moz-user-select":"-moz-none"}),c.bind("click",b,event.proxy),c.bind("dblclick",b,event.proxy),c.bind("mouseover",b,event.proxy),c.bind("mouseout",b,event.proxy),c.bind("mousedown",b,event.proxy),c.bind("mouseup",b,event.proxy),c.bind("contextmenu",b,event.proxy)},unbindTree:function(a){var b=a.treeObj;b.unbind("selectstart",handler.onSelectStart).unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(a){for(var b=[],c=0,d=_init.proxys.length;d>c;c++){var e=_init.proxys[c].apply(this,arguments);if(b.push(e),e.stop)break}return b},proxy:function(a){var b=data.getSetting(a.data.treeId);if(!tools.uCanDo(b,a))return!0;for(var c=event.doProxy(a),d=!0,e=!1,f=0,g=c.length;g>f;f++){var h=c[f];h.nodeEventCallback&&(e=!0,d=h.nodeEventCallback.apply(h,[a,h.node])&&d),h.treeEventCallback&&(e=!0,d=h.treeEventCallback.apply(h,[a,h.node])&&d)}return d}},handler={onSwitchNode:function(a,b){var c=data.getSetting(a.data.treeId);if(b.open){if(0==tools.apply(c.callback.beforeCollapse,[c.treeId,b],!0))return!0;data.getRoot(c).expandTriggerFlag=!0,view.switchNode(c,b)}else{if(0==tools.apply(c.callback.beforeExpand,[c.treeId,b],!0))return!0;data.getRoot(c).expandTriggerFlag=!0,view.switchNode(c,b)}return!0},onClickNode:function(a,b){var c=data.getSetting(a.data.treeId),d=c.view.autoCancelSelected&&(a.ctrlKey||a.metaKey)&&data.isSelectedNode(c,b)?0:c.view.autoCancelSelected&&(a.ctrlKey||a.metaKey)&&c.view.selectedMulti?2:1;return 0==tools.apply(c.callback.beforeClick,[c.treeId,b,d],!0)?!0:(0===d?view.cancelPreSelectedNode(c,b):view.selectNode(c,b,2===d),c.treeObj.trigger(consts.event.CLICK,[a,c.treeId,b,d]),!0)},onZTreeMousedown:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeMouseDown,[c.treeId,b],!0)&&tools.apply(c.callback.onMouseDown,[a,c.treeId,b]),!0},onZTreeMouseup:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeMouseUp,[c.treeId,b],!0)&&tools.apply(c.callback.onMouseUp,[a,c.treeId,b]),!0},onZTreeDblclick:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeDblClick,[c.treeId,b],!0)&&tools.apply(c.callback.onDblClick,[a,c.treeId,b]),!0},onZTreeContextmenu:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeRightClick,[c.treeId,b],!0)&&tools.apply(c.callback.onRightClick,[a,c.treeId,b]),"function"!=typeof c.callback.onRightClick},onSelectStart:function(a){var b=a.originalEvent.srcElement.nodeName.toLowerCase();return"input"===b||"textarea"===b}},tools={apply:function(a,b,c){return"function"==typeof a?a.apply(zt,b?b:[]):c},canAsync:function(a,b){var c=data.nodeChildren(a,b),d=data.nodeIsParent(a,b);return a.async.enable&&b&&d&&!(b.zAsync||c&&c.length>0)},clone:function(a){if(null===a)return null;var b=tools.isArray(a)?[]:{};for(var c in a)b[c]=a[c]instanceof Date?new Date(a[c].getTime()):"object"==typeof a[c]?tools.clone(a[c]):a[c];return b},eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},isElement:function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName},$:function(a,b,c){return b&&"string"!=typeof b&&(c=b,b=""),"string"==typeof a?$(a,c?c.treeObj.get(0).ownerDocument:null):$("#"+a.tId+b,c?c.treeObj:null)},getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&e>d;d++)if(tools.eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},getNodeMainDom:function(a){return $(a).parent("li").get(0)||$(a).parentsUntil("li").parent().get(0)},isChildOrSelf:function(a,b){return $(a).closest("#"+b).length>0},uCanDo:function(a,b){return!0}},view={addNodes:function(a,b,c,d,e){var f=data.nodeIsParent(a,b);if(!a.data.keep.leaf||!b||f)if(tools.isArray(d)||(d=[d]),a.data.simpleData.enable&&(d=data.transformTozTreeFormat(a,d)),b){var g=$$(b,consts.id.SWITCH,a),h=$$(b,consts.id.ICON,a),i=$$(b,consts.id.UL,a);b.open||(view.replaceSwitchClass(b,g,consts.folder.CLOSE),view.replaceIcoClass(b,h,consts.folder.CLOSE),b.open=!1,i.css({display:"none"})),data.addNodesData(a,b,c,d),view.createNodes(a,b.level+1,d,b,c),e||view.expandCollapseParentNode(a,b,!0)}else data.addNodesData(a,data.getRoot(a),c,d),view.createNodes(a,0,d,null,c)},appendNodes:function(a,b,c,d,e,f,g){if(!c)return[];var h,i,j=[],k=d?d:data.getRoot(a),l=data.nodeChildren(a,k);(!l||e>=l.length-c.length)&&(e=-1);for(var m=0,n=c.length;n>m;m++){var o=c[m];f&&(h=(0===e||l.length==c.length)&&0==m,i=0>e&&m==c.length-1,data.initNode(a,b,o,d,h,i,g),data.addNodeCache(a,o));var p=data.nodeIsParent(a,o),q=[],r=data.nodeChildren(a,o);r&&r.length>0&&(q=view.appendNodes(a,b+1,r,o,-1,f,g&&o.open)),g&&(view.makeDOMNodeMainBefore(j,a,o),view.makeDOMNodeLine(j,a,o),data.getBeforeA(a,o,j),view.makeDOMNodeNameBefore(j,a,o),data.getInnerBeforeA(a,o,j),view.makeDOMNodeIcon(j,a,o),data.getInnerAfterA(a,o,j),view.makeDOMNodeNameAfter(j,a,o),data.getAfterA(a,o,j),p&&o.open&&view.makeUlHtml(a,o,j,q.join("")),view.makeDOMNodeMainAfter(j,a,o),data.addCreatedNode(a,o))}return j},appendParentULDom:function(a,b){var c=[],d=$$(b,a);!d.get(0)&&b.parentTId&&(view.appendParentULDom(a,b.getParentNode()),d=$$(b,a));var e=$$(b,consts.id.UL,a);e.get(0)&&e.remove();var f=data.nodeChildren(a,b),g=view.appendNodes(a,b.level+1,f,b,-1,!1,!0);view.makeUlHtml(a,b,c,g.join("")),d.append(c.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l,isParent=data.nodeIsParent(setting,node);if(node&&!isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={},autoParam=tools.apply(setting.async.autoParam,[setting.treeId,node],setting.async.autoParam);for(i=0,l=autoParam.length;node&&l>i;i++){var pKey=autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}var otherParam=tools.apply(setting.async.otherParam,[setting.treeId,node],setting.async.otherParam);if(tools.isArray(otherParam))for(i=0,l=otherParam.length;l>i;i+=2)tmpParam[otherParam[i]]=otherParam[i+1];else for(var p in otherParam)tmpParam[p]=otherParam[p];var _tmpV=data.getRoot(setting)._ver;return $.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:setting.async.contentType.indexOf("application/json")>-1?JSON.stringify(tmpParam):tmpParam,dataType:setting.async.dataType,headers:setting.async.headers,xhrFields:setting.async.xhrFields,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,-1,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,-1,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(a,b,c){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,a,b,c]))}}),!0},cancelPreSelectedNode:function(a,b,c){var d,e,f=data.getRoot(a).curSelectedList;for(d=f.length-1;d>=0;d--)if(e=f[d],b===e||!b&&(!c||c!==e)){if($$(e,consts.id.A,a).removeClass(consts.node.CURSELECTED),b){data.removeSelectedNode(a,b);break}f.splice(d,1),a.treeObj.trigger(consts.event.UNSELECTED,[a.treeId,e])}},createNodeCallback:function(a){if(a.callback.onNodeCreated||a.view.addDiyDom)for(var b=data.getRoot(a);b.createdNodes.length>0;){var c=b.createdNodes.shift();tools.apply(a.view.addDiyDom,[a.treeId,c]),a.callback.onNodeCreated&&a.treeObj.trigger(consts.event.NODECREATED,[a.treeId,c])}},createNodes:function(a,b,c,d,e){if(c&&0!=c.length){var f=data.getRoot(a),g=!d||d.open||!!$$(data.nodeChildren(a,d)[0],a).get(0);f.createdNodes=[];var h,i,j=view.appendNodes(a,b,c,d,e,!0,g);if(d){var k=$$(d,consts.id.UL,a);k.get(0)&&(h=k)}else h=a.treeObj;h&&(e>=0&&(i=h.children()[e]),e>=0&&i?$(i).before(j.join("")):h.append(j.join(""))),view.createNodeCallback(a)}},destroy:function(a){a&&(data.initCache(a),data.initRoot(a),event.unbindTree(a),event.unbindEvent(a),a.treeObj.empty(),delete settings[a.treeId])},expandCollapseNode:function(a,b,c,d,e){var f,g,h=data.getRoot(a);if(!b)return void tools.apply(e,[]);var i=data.nodeChildren(a,b),j=data.nodeIsParent(a,b);if(h.expandTriggerFlag&&(g=e,f=function(){g&&g(),b.open?a.treeObj.trigger(consts.event.EXPAND,[a.treeId,b]):a.treeObj.trigger(consts.event.COLLAPSE,[a.treeId,b])},e=f,h.expandTriggerFlag=!1),!b.open&&j&&(!$$(b,consts.id.UL,a).get(0)||i&&i.length>0&&!$$(i[0],a).get(0))&&(view.appendParentULDom(a,b),view.createNodeCallback(a)),b.open==c)return void tools.apply(e,[]);var k=$$(b,consts.id.UL,a),l=$$(b,consts.id.SWITCH,a),m=$$(b,consts.id.ICON,a);j?(b.open=!b.open,b.iconOpen&&b.iconClose&&m.attr("style",view.makeNodeIcoStyle(a,b)),b.open?(view.replaceSwitchClass(b,l,consts.folder.OPEN),view.replaceIcoClass(b,m,consts.folder.OPEN),0==d||""==a.view.expandSpeed?(k.show(),tools.apply(e,[])):i&&i.length>0?k.slideDown(a.view.expandSpeed,e):(k.show(),tools.apply(e,[]))):(view.replaceSwitchClass(b,l,consts.folder.CLOSE),view.replaceIcoClass(b,m,consts.folder.CLOSE),0!=d&&""!=a.view.expandSpeed&&i&&i.length>0?k.slideUp(a.view.expandSpeed,e):(k.hide(),tools.apply(e,[])))):tools.apply(e,[])},expandCollapseParentNode:function(a,b,c,d,e){if(b){if(!b.parentTId)return void view.expandCollapseNode(a,b,c,d,e);view.expandCollapseNode(a,b,c,d),b.parentTId&&view.expandCollapseParentNode(a,b.getParentNode(),c,d,e)}},expandCollapseSonNode:function(a,b,c,d,e){var f=data.getRoot(a),g=b?data.nodeChildren(a,b):data.nodeChildren(a,f),h=b?!1:d,i=data.getRoot(a).expandTriggerFlag;if(data.getRoot(a).expandTriggerFlag=!1,g)for(var j=0,k=g.length;k>j;j++)g[j]&&view.expandCollapseSonNode(a,g[j],c,h);data.getRoot(a).expandTriggerFlag=i,view.expandCollapseNode(a,b,c,d,e)},isSelectedNode:function(a,b){if(!b)return!1;var c,d=data.getRoot(a).curSelectedList;for(c=d.length-1;c>=0;c--)if(b===d[c])return!0;return!1},makeDOMNodeIcon:function(a,b,c){var d=data.nodeName(b,c),e=b.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");a.push("<span id='",c.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(b,c),"' style='",view.makeNodeIcoStyle(b,c),"'></span><span id='",c.tId,consts.id.SPAN,"' class='",consts.className.NAME,"'>",e,"</span>")},makeDOMNodeLine:function(a,b,c){a.push("<span id='",c.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(b,c),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(a,b,c){a.push("</li>")},makeDOMNodeMainBefore:function(a,b,c){a.push("<li id='",c.tId,"' class='",consts.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(a,b,c){a.push("</a>")},makeDOMNodeNameBefore:function(a,b,c){var d=data.nodeTitle(b,c),e=view.makeNodeUrl(b,c),f=view.makeNodeFontCss(b,c),g=[];for(var h in f)g.push(h,":",f[h],";");a.push("<a id='",c.tId,consts.id.A,"' class='",consts.className.LEVEL,c.level,"' treeNode",consts.id.A,' onclick="',c.click||"",'" ',null!=e&&e.length>0?"href='"+e+"'":""," target='",view.makeNodeTarget(c),"' style='",g.join(""),"'"),tools.apply(b.view.showTitle,[b.treeId,c],b.view.showTitle)&&d&&a.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),a.push(">")},makeNodeFontCss:function(a,b){var c=tools.apply(a.view.fontCss,[a.treeId,b],a.view.fontCss);return c&&"function"!=typeof c?c:{}},makeNodeIcoClass:function(a,b){var c=["ico"];if(!b.isAjaxing){var d=data.nodeIsParent(a,b);c[0]=(b.iconSkin?b.iconSkin+"_":"")+c[0],d?c.push(b.open?consts.folder.OPEN:consts.folder.CLOSE):c.push(consts.folder.DOCU)}return consts.className.BUTTON+" "+c.join("_")},makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=data.nodeIsParent(a,b),e=d&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b[a.data.key.icon];e&&c.push("background:url(",e,") 0 0 no-repeat;"),0!=a.view.showIcon&&tools.apply(a.view.showIcon,[a.treeId,b],!0)||c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(a,b){var c=[];return a.view.showLine?0==b.level&&b.isFirstNode&&b.isLastNode?c.push(consts.line.ROOT):0==b.level&&b.isFirstNode?c.push(consts.line.ROOTS):b.isLastNode?c.push(consts.line.BOTTOM):c.push(consts.line.CENTER):c.push(consts.line.NOLINE),data.nodeIsParent(a,b)?c.push(b.open?consts.folder.OPEN:consts.folder.CLOSE):c.push(consts.folder.DOCU),view.makeNodeLineClassEx(b)+c.join("_")},makeNodeLineClassEx:function(a){return consts.className.BUTTON+" "+consts.className.LEVEL+a.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(a,b){var c=a.data.key.url;return b[c]?b[c]:null},makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,consts.id.UL,"' class='",consts.className.LEVEL,b.level," ",view.makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>"),c.push(d),c.push("</ul>")},makeUlLineClass:function(a,b){return a.view.showLine&&!b.isLastNode?consts.line.LINE:""},removeChildNodes:function(a,b){if(b){var c=data.nodeChildren(a,b);if(c){for(var d=0,e=c.length;e>d;d++)data.removeNodeCache(a,c[d]);if(data.removeSelectedNode(a),delete b[a.data.key.children],a.data.keep.parent)$$(b,consts.id.UL,a).empty();else{data.nodeIsParent(a,b,!1),b.open=!1;var f=$$(b,consts.id.SWITCH,a),g=$$(b,consts.id.ICON,a);view.replaceSwitchClass(b,f,consts.folder.DOCU),view.replaceIcoClass(b,g,consts.folder.DOCU),$$(b,consts.id.UL,a).remove()}}}},scrollIntoView:function(a,b){if(b){if("undefined"==typeof Element){var c=a.treeObj.get(0).getBoundingClientRect(),d=b.getBoundingClientRect();return void((d.top<c.top||d.bottom>c.bottom||d.right>c.right||d.left<c.left)&&b.scrollIntoView())}Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(a){"use strict";function b(a,b){return{start:a,length:b,end:a+b}}function c(b,c){return!1===a||c.start<b.end&&b.start<c.end?Math.max(b.end-c.length,Math.min(c.start,b.start)):(b.start+b.end-c.length)/2}function d(a,b){return{x:a,y:b,translate:function(c,e){return d(a+c,b+e)}}}function e(a,b){for(;a;)b=b.translate(a.offsetLeft,a.offsetTop),a=a.offsetParent;return b}for(var f,g=e(this,d(0,0)),h=d(this.offsetWidth,this.offsetHeight),i=this.parentNode;i instanceof HTMLElement;)f=e(i,d(i.clientLeft,i.clientTop)),i.scrollLeft=c(b(g.x-f.x,h.x),b(i.scrollLeft,i.clientWidth)),i.scrollTop=c(b(g.y-f.y,h.y),b(i.scrollTop,i.clientHeight)),g=g.translate(-i.scrollLeft,-i.scrollTop),i=i.parentNode}),b.scrollIntoViewIfNeeded()}},setFirstNode:function(a,b){var c=data.nodeChildren(a,b);c.length>0&&(c[0].isFirstNode=!0)},setLastNode:function(a,b){var c=data.nodeChildren(a,b);c.length>0&&(c[c.length-1].isLastNode=!0)},removeNode:function(a,b){var c=data.getRoot(a),d=b.parentTId?b.getParentNode():c;if(b.isFirstNode=!1,b.isLastNode=!1,b.getPreNode=function(){return null},b.getNextNode=function(){return null},data.getNodeCache(a,b.tId)){$$(b,a).remove(),data.removeNodeCache(a,b),data.removeSelectedNode(a,b);for(var e=data.nodeChildren(a,d),f=0,g=e.length;g>f;f++)if(e[f].tId==b.tId){e.splice(f,1);break}view.setFirstNode(a,d),view.setLastNode(a,d);var h,i,j,k=e.length;if(a.data.keep.parent||0!=k){if(a.view.showLine&&k>0){var l=e[k-1];if(h=$$(l,consts.id.UL,a),i=$$(l,consts.id.SWITCH,a),j=$$(l,consts.id.ICON,a),d==c)if(1==e.length)view.replaceSwitchClass(l,i,consts.line.ROOT);else{var m=$$(e[0],consts.id.SWITCH,a);view.replaceSwitchClass(e[0],m,consts.line.ROOTS),view.replaceSwitchClass(l,i,consts.line.BOTTOM)}else view.replaceSwitchClass(l,i,consts.line.BOTTOM);h.removeClass(consts.line.LINE)}}else data.nodeIsParent(a,d,!1),d.open=!1,delete d[a.data.key.children],h=$$(d,consts.id.UL,a),i=$$(d,consts.id.SWITCH,a),j=$$(d,consts.id.ICON,a),view.replaceSwitchClass(d,i,consts.folder.DOCU),view.replaceIcoClass(d,j,consts.folder.DOCU),h.css("display","none")}},replaceIcoClass:function(a,b,c){if(b&&!a.isAjaxing){var d=b.attr("class");if(void 0!=d){var e=d.split("_");switch(c){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:e[e.length-1]=c}b.attr("class",e.join("_"))}}},replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){var e=d.split("_");switch(c){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:e[0]=view.makeNodeLineClassEx(a)+c;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:e[1]=c}b.attr("class",e.join("_")),c!==consts.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},selectNode:function(a,b,c){c||view.cancelPreSelectedNode(a,null,b),$$(b,consts.id.A,a).addClass(consts.node.CURSELECTED),data.addSelectedNode(a,b),a.treeObj.trigger(consts.event.SELECTED,[a.treeId,b])},setNodeFontCss:function(a,b){var c=$$(b,consts.id.A,a),d=view.makeNodeFontCss(a,b);d&&c.css(d)},setNodeLineIcos:function(a,b){if(b){var c=$$(b,consts.id.SWITCH,a),d=$$(b,consts.id.UL,a),e=$$(b,consts.id.ICON,a),f=view.makeUlLineClass(a,b);0==f.length?d.removeClass(consts.line.LINE):d.addClass(f),c.attr("class",view.makeNodeLineClass(a,b)),data.nodeIsParent(a,b)?c.removeAttr("disabled"):c.attr("disabled","disabled"),e.removeAttr("style"),e.attr("style",view.makeNodeIcoStyle(a,b)),e.attr("class",view.makeNodeIcoClass(a,b))}},setNodeName:function(a,b){var c=data.nodeTitle(a,b),d=$$(b,consts.id.SPAN,a);if(d.empty(),a.view.nameIsHTML?d.html(data.nodeName(a,b)):d.text(data.nodeName(a,b)),tools.apply(a.view.showTitle,[a.treeId,b],a.view.showTitle)){var e=$$(b,consts.id.A,a);e.attr("title",c?c:"")}},setNodeTarget:function(a,b){var c=$$(b,consts.id.A,a);c.attr("target",view.makeNodeTarget(b))},setNodeUrl:function(a,b){var c=$$(b,consts.id.A,a),d=view.makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",d)},switchNode:function(a,b){if(b.open||!tools.canAsync(a,b))view.expandCollapseNode(a,b,!b.open);else if(a.async.enable){if(!view.asyncNode(a,b))return void view.expandCollapseNode(a,b,!b.open)}else b&&view.expandCollapseNode(a,b,!b.open)}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(a){var b=data.getZTreeTools(a);return b?b:null},destroy:function(a){if(a&&a.length>0)view.destroy(data.getSetting(a));else for(var b in settings)view.destroy(settings[b])},init:function(a,b,c){var d=tools.clone(_setting);$.extend(!0,d,b),d.treeId=a.attr("id"),d.treeObj=a,d.treeObj.empty(),settings[d.treeId]=d,"undefined"==typeof document.body.style.maxHeight&&(d.view.expandSpeed=""),data.initRoot(d);var e=data.getRoot(d);c=c?tools.clone(tools.isArray(c)?c:[c]):[],d.data.simpleData.enable?data.nodeChildren(d,e,data.transformTozTreeFormat(d,c)):data.nodeChildren(d,e,c),data.initCache(d),event.unbindTree(d),event.bindTree(d),event.unbindEvent(d),event.bindEvent(d);var f={setting:d,addNodes:function(a,b,c,e){function f(){view.addNodes(d,a,b,i,1==e)}a||(a=null);var g=data.nodeIsParent(d,a);if(a&&!g&&d.data.keep.leaf)return null;var h=parseInt(b,10);if(isNaN(h)?(e=!!c,c=b,b=-1):b=h,!c)return null;var i=tools.clone(tools.isArray(c)?c:[c]);return tools.canAsync(d,a)?view.asyncNode(d,a,e,f):f(),
i},cancelSelectedNode:function(a){view.cancelPreSelectedNode(d,a)},destroy:function(){view.destroy(d)},expandAll:function(a){return a=!!a,view.expandCollapseSonNode(d,null,a,!0),a},expandNode:function(a,b,c,e,f){function g(){var b=$$(a,d).get(0);b&&e!==!1&&view.scrollIntoView(d,b)}return a&&data.nodeIsParent(d,a)?(b!==!0&&b!==!1&&(b=!a.open),f=!!f,f&&b&&0==tools.apply(d.callback.beforeExpand,[d.treeId,a],!0)?null:f&&!b&&0==tools.apply(d.callback.beforeCollapse,[d.treeId,a],!0)?null:(b&&a.parentTId&&view.expandCollapseParentNode(d,a.getParentNode(),b,!1),b!==a.open||c?(data.getRoot(d).expandTriggerFlag=f,!tools.canAsync(d,a)&&c?view.expandCollapseSonNode(d,a,b,!0,g):(a.open=!b,view.switchNode(this.setting,a),g()),b):null)):null},getNodes:function(){return data.getNodes(d)},getNodeByParam:function(a,b,c){return a?data.getNodeByParam(d,c?data.nodeChildren(d,c):data.getNodes(d),a,b):null},getNodeByTId:function(a){return data.getNodeCache(d,a)},getNodesByParam:function(a,b,c){return a?data.getNodesByParam(d,c?data.nodeChildren(d,c):data.getNodes(d),a,b):null},getNodesByParamFuzzy:function(a,b,c){return a?data.getNodesByParamFuzzy(d,c?data.nodeChildren(d,c):data.getNodes(d),a,b):null},getNodesByFilter:function(a,b,c,e){return b=!!b,a&&"function"==typeof a?data.getNodesByFilter(d,c?data.nodeChildren(d,c):data.getNodes(d),a,b,e):b?null:[]},getNodeIndex:function(a){if(!a)return null;for(var b=a.parentTId?a.getParentNode():data.getRoot(d),c=data.nodeChildren(d,b),e=0,f=c.length;f>e;e++)if(c[e]==a)return e;return-1},getSelectedNodes:function(){for(var a=[],b=data.getRoot(d).curSelectedList,c=0,e=b.length;e>c;c++)a.push(b[c]);return a},isSelectedNode:function(a){return data.isSelectedNode(d,a)},reAsyncChildNodesPromise:function(a,b,c){var d=new Promise(function(d,e){try{f.reAsyncChildNodes(a,b,c,function(){d(a)})}catch(g){e(g)}});return d},reAsyncChildNodes:function(a,b,c,e){if(this.setting.async.enable){var f=!a;if(f&&(a=data.getRoot(d)),"refresh"==b){for(var g=data.nodeChildren(d,a),h=0,i=g?g.length:0;i>h;h++)data.removeNodeCache(d,g[h]);if(data.removeSelectedNode(d),data.nodeChildren(d,a,[]),f)this.setting.treeObj.empty();else{var j=$$(a,consts.id.UL,d);j.empty()}}view.asyncNode(this.setting,f?null:a,!!c,e)}},refresh:function(){this.setting.treeObj.empty();var a=data.getRoot(d),b=data.nodeChildren(d,a);data.initRoot(d),data.nodeChildren(d,a,b),data.initCache(d),view.createNodes(d,0,data.nodeChildren(d,a),null,-1)},removeChildNodes:function(a){if(!a)return null;var b=data.nodeChildren(d,a);return view.removeChildNodes(d,a),b?b:null},removeNode:function(a,b){a&&(b=!!b,b&&0==tools.apply(d.callback.beforeRemove,[d.treeId,a],!0)||(view.removeNode(d,a),b&&this.setting.treeObj.trigger(consts.event.REMOVE,[d.treeId,a])))},selectNode:function(a,b,c){function e(){if(!c){var b=$$(a,d).get(0);view.scrollIntoView(d,b)}}if(a&&tools.uCanDo(d)){if(b=d.view.selectedMulti&&b,a.parentTId)view.expandCollapseParentNode(d,a.getParentNode(),!0,!1,e);else if(!c)try{$$(a,d).focus().blur()}catch(f){}view.selectNode(d,a,b)}},transformTozTreeNodes:function(a){return data.transformTozTreeFormat(d,a)},transformToArray:function(a){return data.transformToArrayFormat(d,a)},updateNode:function(a,b){if(a){var c=$$(a,d);c.get(0)&&tools.uCanDo(d)&&(view.setNodeName(d,a),view.setNodeTarget(d,a),view.setNodeUrl(d,a),view.setNodeLineIcos(d,a),view.setNodeFontCss(d,a))}}};e.treeTools=f,data.setZTreeTools(d,f);var g=data.nodeChildren(d,e);return g&&g.length>0?view.createNodes(d,0,g,null,-1):d.async.enable&&d.async.url&&""!==d.async.url&&view.asyncNode(d),f}};var zt=$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(a){var b={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},c={check:{enable:!1,autoCheckTrigger:!1,chkStyle:b.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:b.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},d=function(a){var b=v.getRoot(a);b.radioCheckedList=[]},e=function(a){},f=function(a){var b=a.treeObj,c=t.event;b.bind(c.CHECK,function(b,c,d,e){b.srcEvent=c,s.apply(a.callback.onCheck,[b,d,e])})},g=function(a){var b=a.treeObj,c=t.event;b.unbind(c.CHECK)},h=function(a){var b=a.target,c=v.getSetting(a.data.treeId),d="",e=null,f="",g="",h=null,i=null;if(s.eqs(a.type,"mouseover")?c.check.enable&&s.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+t.id.CHECK)&&(d=s.getNodeMainDom(b).id,f="mouseoverCheck"):s.eqs(a.type,"mouseout")?c.check.enable&&s.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+t.id.CHECK)&&(d=s.getNodeMainDom(b).id,f="mouseoutCheck"):s.eqs(a.type,"click")&&c.check.enable&&s.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+t.id.CHECK)&&(d=s.getNodeMainDom(b).id,f="checkNode"),d.length>0)switch(e=v.getNodeCache(c,d),f){case"checkNode":h=n.onCheckNode;break;case"mouseoverCheck":h=n.onMouseoverCheck;break;case"mouseoutCheck":h=n.onMouseoutCheck}var j={stop:"checkNode"===f,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return j},i=function(a,b,c,d,e,f,g){if(c){var h=v.nodeChecked(a,c);if(c.checkedOld=h,"string"==typeof c.nocheck&&(c.nocheck=s.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||a.check.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=s.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||a.check.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=s.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return v.getCheckStatus(a,c)},a.check.chkStyle==t.radio.STYLE&&a.check.radioType==t.radio.TYPE_ALL&&h){var i=v.getRoot(a);i.radioCheckedList.push(c)}}},j=function(a,b,c){a.check.enable&&(v.makeChkFlag(a,b),c.push("<span ID='",b.tId,t.id.CHECK,"' class='",u.makeChkClass(a,b),"' treeNode",t.id.CHECK,b.nocheck===!0?" style='display:none;'":"","></span>"))},k=function(a,b){b.checkNode=function(b,c,d,e){var f=v.nodeChecked(a,b);if(b.chkDisabled!==!0&&(c!==!0&&c!==!1&&(c=!f),e=!!e,(f!==c||d)&&(!e||0!=s.apply(this.setting.callback.beforeCheck,[this.setting.treeId,b],!0))&&s.uCanDo(this.setting)&&this.setting.check.enable&&b.nocheck!==!0)){v.nodeChecked(a,b,c);var g=w(b,t.id.CHECK,this.setting);(d||this.setting.check.chkStyle===t.radio.STYLE)&&u.checkNodeRelation(this.setting,b),u.setChkClass(this.setting,g,b),u.repairParentChkClassWithSelf(this.setting,b),e&&this.setting.treeObj.trigger(t.event.CHECK,[null,this.setting.treeId,b])}},b.checkAllNodes=function(a){u.repairAllChk(this.setting,!!a)},b.getCheckedNodes=function(b){var b=b!==!1,c=v.nodeChildren(a,v.getRoot(this.setting));return v.getTreeCheckedNodes(this.setting,c,b)},b.getChangeCheckedNodes=function(){var b=v.nodeChildren(a,v.getRoot(this.setting));return v.getTreeChangeCheckedNodes(this.setting,b)},b.setChkDisabled=function(a,b,c,d){b=!!b,c=!!c,d=!!d,u.repairSonChkDisabled(this.setting,a,b,d),u.repairParentChkDisabled(this.setting,a.getParentNode(),b,c)};var c=b.updateNode;b.updateNode=function(a,d){if(c&&c.apply(b,arguments),a&&this.setting.check.enable){var e=w(a,this.setting);if(e.get(0)&&s.uCanDo(this.setting)){var f=w(a,t.id.CHECK,this.setting);(1==d||this.setting.check.chkStyle===t.radio.STYLE)&&u.checkNodeRelation(this.setting,a),u.setChkClass(this.setting,f,a),u.repairParentChkClassWithSelf(this.setting,a)}}}},l={getRadioCheckedList:function(a){for(var b=v.getRoot(a).radioCheckedList,c=0,d=b.length;d>c;c++)v.getNodeCache(a,b[c].tId)||(b.splice(c,1),c--,d--);return b},getCheckStatus:function(a,b){if(!a.check.enable||b.nocheck||b.chkDisabled)return null;var c=v.nodeChecked(a,b),d={checked:c,half:b.halfCheck?b.halfCheck:a.check.chkStyle==t.radio.STYLE?2===b.check_Child_State:c?b.check_Child_State>-1&&b.check_Child_State<2:b.check_Child_State>0};return d},getTreeCheckedNodes:function(a,b,c,d){if(!b)return[];var e=c&&a.check.chkStyle==t.radio.STYLE&&a.check.radioType==t.radio.TYPE_ALL;d=d?d:[];for(var f=0,g=b.length;g>f;f++){var h=b[f],i=v.nodeChildren(a,h),j=v.nodeChecked(a,h);if(h.nocheck!==!0&&h.chkDisabled!==!0&&j==c&&(d.push(h),e))break;if(v.getTreeCheckedNodes(a,i,c,d),e&&d.length>0)break}return d},getTreeChangeCheckedNodes:function(a,b,c){if(!b)return[];c=c?c:[];for(var d=0,e=b.length;e>d;d++){var f=b[d],g=v.nodeChildren(a,f),h=v.nodeChecked(a,f);f.nocheck!==!0&&f.chkDisabled!==!0&&h!=f.checkedOld&&c.push(f),v.getTreeChangeCheckedNodes(a,g,c)}return c},makeChkFlag:function(a,b){if(b){var c=-1,d=v.nodeChildren(a,b);if(d)for(var e=0,f=d.length;f>e;e++){var g=d[e],h=v.nodeChecked(a,g),i=-1;if(a.check.chkStyle==t.radio.STYLE){if(i=g.nocheck===!0||g.chkDisabled===!0?g.check_Child_State:g.halfCheck===!0?2:h?2:g.check_Child_State>0?2:0,2==i){c=2;break}0==i&&(c=0)}else if(a.check.chkStyle==t.checkbox.STYLE){if(i=g.nocheck===!0||g.chkDisabled===!0?g.check_Child_State:g.halfCheck===!0?1:h?-1===g.check_Child_State||2===g.check_Child_State?2:1:g.check_Child_State>0?1:0,1===i){c=1;break}if(2===i&&c>-1&&e>0&&i!==c){c=1;break}if(2===c&&i>-1&&2>i){c=1;break}i>-1&&(c=i)}}b.check_Child_State=c}}},m={},n={onCheckNode:function(a,b){if(b.chkDisabled===!0)return!1;var c=v.getSetting(a.data.treeId);if(0==s.apply(c.callback.beforeCheck,[c.treeId,b],!0))return!0;var d=v.nodeChecked(c,b);v.nodeChecked(c,b,!d),u.checkNodeRelation(c,b);var e=w(b,t.id.CHECK,c);return u.setChkClass(c,e,b),u.repairParentChkClassWithSelf(c,b),c.treeObj.trigger(t.event.CHECK,[a,c.treeId,b]),!0},onMouseoverCheck:function(a,b){if(b.chkDisabled===!0)return!1;var c=v.getSetting(a.data.treeId),d=w(b,t.id.CHECK,c);return b.check_Focus=!0,u.setChkClass(c,d,b),!0},onMouseoutCheck:function(a,b){if(b.chkDisabled===!0)return!1;var c=v.getSetting(a.data.treeId),d=w(b,t.id.CHECK,c);return b.check_Focus=!1,u.setChkClass(c,d,b),!0}},o={},p={checkNodeRelation:function(a,b){var c,d,e,f=t.radio,g=v.nodeChecked(a,b);if(a.check.chkStyle==f.STYLE){var h=v.getRadioCheckedList(a);if(g)if(a.check.radioType==f.TYPE_ALL){for(d=h.length-1;d>=0;d--){c=h[d];var i=v.nodeChecked(a,c);i&&c!=b&&(v.nodeChecked(a,c,!1),h.splice(d,1),u.setChkClass(a,w(c,t.id.CHECK,a),c),c.parentTId!=b.parentTId&&u.repairParentChkClassWithSelf(a,c))}h.push(b)}else{var j=b.parentTId?b.getParentNode():v.getRoot(a),k=v.nodeChildren(a,j);for(d=0,e=k.length;e>d;d++){c=k[d];var i=v.nodeChecked(a,c);i&&c!=b&&(v.nodeChecked(a,c,!1),u.setChkClass(a,w(c,t.id.CHECK,a),c))}}else if(a.check.radioType==f.TYPE_ALL)for(d=0,e=h.length;e>d;d++)if(b==h[d]){h.splice(d,1);break}}else{var k=v.nodeChildren(a,b);g&&(!k||0==k.length||a.check.chkboxType.Y.indexOf("s")>-1)&&u.setSonNodeCheckBox(a,b,!0),g||k&&0!=k.length&&!(a.check.chkboxType.N.indexOf("s")>-1)||u.setSonNodeCheckBox(a,b,!1),g&&a.check.chkboxType.Y.indexOf("p")>-1&&u.setParentNodeCheckBox(a,b,!0),!g&&a.check.chkboxType.N.indexOf("p")>-1&&u.setParentNodeCheckBox(a,b,!1)}},makeChkClass:function(a,b){var c=t.checkbox,d=t.radio,e="",f=v.nodeChecked(a,b);e=b.chkDisabled===!0?c.DISABLED:b.halfCheck?c.PART:a.check.chkStyle==d.STYLE?b.check_Child_State<1?c.FULL:c.PART:f?2===b.check_Child_State||-1===b.check_Child_State?c.FULL:c.PART:b.check_Child_State<1?c.FULL:c.PART;var g=a.check.chkStyle+"_"+(f?c.TRUE:c.FALSE)+"_"+e;return g=b.check_Focus&&b.chkDisabled!==!0?g+"_"+c.FOCUS:g,t.className.BUTTON+" "+c.DEFAULT+" "+g},repairAllChk:function(a,b){if(a.check.enable&&a.check.chkStyle===t.checkbox.STYLE)for(var c=v.getRoot(a),d=v.nodeChildren(a,c),e=0,f=d.length;f>e;e++){var g=d[e];g.nocheck!==!0&&g.chkDisabled!==!0&&v.nodeChecked(a,g,b),u.setSonNodeCheckBox(a,g,b)}},repairChkClass:function(a,b){if(b&&(v.makeChkFlag(a,b),b.nocheck!==!0)){var c=w(b,t.id.CHECK,a);u.setChkClass(a,c,b)}},repairParentChkClass:function(a,b){if(b&&b.parentTId){var c=b.getParentNode();u.repairChkClass(a,c),u.repairParentChkClass(a,c)}},repairParentChkClassWithSelf:function(a,b){if(b){var c=v.nodeChildren(a,b);c&&c.length>0?u.repairParentChkClass(a,c[0]):u.repairParentChkClass(a,b)}},repairSonChkDisabled:function(a,b,c,d){if(b){b.chkDisabled!=c&&(b.chkDisabled=c),u.repairChkClass(a,b);var e=v.nodeChildren(a,b);if(e&&d)for(var f=0,g=e.length;g>f;f++){var h=e[f];u.repairSonChkDisabled(a,h,c,d)}}},repairParentChkDisabled:function(a,b,c,d){b&&(b.chkDisabled!=c&&d&&(b.chkDisabled=c),u.repairChkClass(a,b),u.repairParentChkDisabled(a,b.getParentNode(),c,d))},setChkClass:function(a,b,c){b&&(c.nocheck===!0?b.hide():b.show(),b.attr("class",u.makeChkClass(a,c)))},setParentNodeCheckBox:function(a,b,c,d){var e=w(b,t.id.CHECK,a);if(d||(d=b),v.makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0&&(v.nodeChecked(a,b,c),u.setChkClass(a,e,b),a.check.autoCheckTrigger&&b!=d&&a.treeObj.trigger(t.event.CHECK,[null,a.treeId,b])),b.parentTId){var f=!0;if(!c)for(var g=v.nodeChildren(a,b.getParentNode()),h=0,i=g.length;i>h;h++){var j=g[h],k=v.nodeChecked(a,j);if(j.nocheck!==!0&&j.chkDisabled!==!0&&k||(j.nocheck===!0||j.chkDisabled===!0)&&j.check_Child_State>0){f=!1;break}}f&&u.setParentNodeCheckBox(a,b.getParentNode(),c,d)}},setSonNodeCheckBox:function(a,b,c,d){if(b){var e=w(b,t.id.CHECK,a);d||(d=b);var f=!1,g=v.nodeChildren(a,b);if(g)for(var h=0,i=g.length;i>h;h++){var j=g[h];u.setSonNodeCheckBox(a,j,c,d),j.chkDisabled===!0&&(f=!0)}b!=v.getRoot(a)&&b.chkDisabled!==!0&&(f&&b.nocheck!==!0&&v.makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0?(v.nodeChecked(a,b,c),f||(b.check_Child_State=g&&g.length>0?c?2:0:-1)):b.check_Child_State=-1,u.setChkClass(a,e,b),a.check.autoCheckTrigger&&b!=d&&b.nocheck!==!0&&b.chkDisabled!==!0&&a.treeObj.trigger(t.event.CHECK,[null,a.treeId,b]))}}},q={tools:o,view:p,event:m,data:l};a.extend(!0,a.fn.zTree.consts,b),a.extend(!0,a.fn.zTree._z,q);var r=a.fn.zTree,s=r._z.tools,t=r.consts,u=r._z.view,v=r._z.data,w=(r._z.event,s.$);v.nodeChecked=function(a,b,c){if(!b)return!1;var d=a.data.key.checked;return"undefined"!=typeof c?("string"==typeof c&&(c=s.eqs(c,"true")),c=!!c,b[d]=c):"string"==typeof b[d]?b[d]=s.eqs(b[d],"true"):b[d]=!!b[d],b[d]},v.exSetting(c),v.addInitBind(f),v.addInitUnBind(g),v.addInitCache(e),v.addInitNode(i),v.addInitProxy(h,!0),v.addInitRoot(d),v.addBeforeA(j),v.addZTreeTools(k);var x=u.createNodes;u.createNodes=function(a,b,c,d,e){x&&x.apply(u,arguments),c&&u.repairParentChkClassWithSelf(a,d)};var y=u.removeNode;u.removeNode=function(a,b){var c=b.getParentNode();y&&y.apply(u,arguments),b&&c&&(u.repairChkClass(a,c),u.repairParentChkClass(a,c))};var z=u.appendNodes;u.appendNodes=function(a,b,c,d,e,f,g){var h="";return z&&(h=z.apply(u,arguments)),d&&v.makeChkFlag(a,d),h}}(jQuery),function(a){var b={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},c={edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}},d=function(a){var b=u.getRoot(a),c=u.getRoots();b.curEditNode=null,b.curEditInput=null,b.curHoverNode=null,b.dragFlag=0,b.dragNodeShowBefore=[],b.dragMaskList=new Array,c.showHoverDom=!0},e=function(a){},f=function(a){var b=a.treeObj,c=s.event;b.bind(c.RENAME,function(b,c,d,e){r.apply(a.callback.onRename,[b,c,d,e])}),b.bind(c.DRAG,function(b,c,d,e){r.apply(a.callback.onDrag,[c,d,e])}),b.bind(c.DRAGMOVE,function(b,c,d,e){r.apply(a.callback.onDragMove,[c,d,e])}),b.bind(c.DROP,function(b,c,d,e,f,g,h){r.apply(a.callback.onDrop,[c,d,e,f,g,h])})},g=function(a){var b=a.treeObj,c=s.event;b.unbind(c.RENAME),b.unbind(c.DRAG),b.unbind(c.DRAGMOVE),b.unbind(c.DROP)},h=function(a){var b=a.target,c=u.getSetting(a.data.treeId),d=a.relatedTarget,e="",f=null,g="",h="",i=null,j=null,k=null;if(r.eqs(a.type,"mouseover")?(k=r.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+s.id.A}]),k&&(e=r.getNodeMainDom(k).id,g="hoverOverNode")):r.eqs(a.type,"mouseout")?(k=r.getMDom(c,d,[{tagName:"a",attrName:"treeNode"+s.id.A}]),k||(e="remove",g="hoverOutNode")):r.eqs(a.type,"mousedown")&&(k=r.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+s.id.A}]),k&&(e=r.getNodeMainDom(k).id,g="mousedownNode")),e.length>0)switch(f=u.getNodeCache(c,e),g){case"mousedownNode":i=m.onMousedownNode;break;case"hoverOverNode":i=m.onHoverOverNode;break;case"hoverOutNode":i=m.onHoverOutNode}var l={stop:!1,node:f,nodeEventType:g,nodeEventCallback:i,treeEventType:h,treeEventCallback:j};return l},i=function(a,b,c,d,e,f,g){c&&(c.isHover=!1,c.editNameFlag=!1)},j=function(a,b){b.cancelEditName=function(a){var b=u.getRoot(this.setting);b.curEditNode&&t.cancelCurEditNode(this.setting,a?a:null,!0)},b.copyNode=function(b,c,d,e){function f(){t.addNodes(h.setting,b,-1,[i],e)}if(!c)return null;var g=u.nodeIsParent(a,b);if(b&&!g&&this.setting.data.keep.leaf&&d===s.move.TYPE_INNER)return null;var h=this,i=r.clone(c);return b||(b=null,d=s.move.TYPE_INNER),d==s.move.TYPE_INNER?r.canAsync(this.setting,b)?t.asyncNode(this.setting,b,e,f):f():(t.addNodes(this.setting,b.parentNode,-1,[i],e),t.moveNode(this.setting,b,i,d,!1,e)),i},b.editName=function(a){a&&a.tId&&a===u.getNodeCache(this.setting,a.tId)&&(a.parentTId&&t.expandCollapseParentNode(this.setting,a.getParentNode(),!0),t.editNode(this.setting,a))},b.moveNode=function(b,c,d,e){function f(){t.moveNode(h.setting,b,c,d,!1,e)}if(!c)return c;var g=u.nodeIsParent(a,b);if(b&&!g&&this.setting.data.keep.leaf&&d===s.move.TYPE_INNER)return null;if(b&&(c.parentTId==b.tId&&d==s.move.TYPE_INNER||v(c,this.setting).find("#"+b.tId).length>0))return null;b||(b=null);var h=this;return r.canAsync(this.setting,b)&&d===s.move.TYPE_INNER?t.asyncNode(this.setting,b,e,f):f(),c},b.setEditable=function(a){return this.setting.edit.enable=a,this.refresh()}},k={setSonNodeLevel:function(a,b,c){if(c){var d=u.nodeChildren(a,c);if(c.level=b?b.level+1:0,d)for(var e=0,f=d.length;f>e;e++)d[e]&&u.setSonNodeLevel(a,c,d[e])}}},l={},m={onHoverOverNode:function(a,b){var c=u.getSetting(a.data.treeId),d=u.getRoot(c);d.curHoverNode!=b&&m.onHoverOutNode(a),d.curHoverNode=b,t.addHoverDom(c,b)},onHoverOutNode:function(a,b){var c=u.getSetting(a.data.treeId),d=u.getRoot(c);d.curHoverNode&&!u.isSelectedNode(c,d.curHoverNode)&&(t.removeTreeDom(c,d.curHoverNode),d.curHoverNode=null)},onMousedownNode:function(c,d){function e(c){function d(){w=null,G="",H=s.move.TYPE_INNER,q.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}if(0==k.dragFlag&&Math.abs(I-c.clientX)<j.edit.drag.minMoveSize&&Math.abs(J-c.clientY)<j.edit.drag.minMoveSize)return!0;var e,g,h,i,m;if(A.css("cursor","pointer"),0==k.dragFlag){if(0==r.apply(j.callback.beforeDrag,[j.treeId,o],!0))return f(c),!0;for(e=0,g=o.length;g>e;e++)0==e&&(k.dragNodeShowBefore=[]),h=o[e],u.nodeIsParent(j,h)&&h.open?(t.expandCollapseNode(j,h,!h.open),k.dragNodeShowBefore[h.tId]=!0):k.dragNodeShowBefore[h.tId]=!1;k.dragFlag=1,l.showHoverDom=!1,r.showIfameMask(j,!0);var n=!0,D=-1;if(o.length>1){var L=o[0].parentTId?u.nodeChildren(j,o[0].getParentNode()):u.getNodes(j);for(m=[],e=0,g=L.length;g>e;e++)if(void 0!==k.dragNodeShowBefore[L[e].tId]&&(n&&D>-1&&D+1!==e&&(n=!1),m.push(L[e]),D=e),o.length===m.length){o=m;break}}for(n&&(x=o[0].getPreNode(),y=o[o.length-1].getNextNode()),p=v("<ul class='zTreeDragUL'></ul>",j),e=0,g=o.length;g>e;e++)h=o[e],h.editNameFlag=!1,t.selectNode(j,h,e>0),t.removeTreeDom(j,h),e>j.edit.drag.maxShowNodeNum-1||(i=v("<li id='"+h.tId+"_tmp'></li>",j),i.append(v(h,s.id.A,j).clone()),i.css("padding","0"),i.children("#"+h.tId+s.id.A).removeClass(s.node.CURSELECTED),p.append(i),e==j.edit.drag.maxShowNodeNum-1&&(i=v("<li id='"+h.tId+"_moretmp'><a>  ...  </a></li>",j),p.append(i)));p.attr("id",o[0].tId+s.id.UL+"_tmp"),p.addClass(j.treeObj.attr("class")),p.appendTo(A),q=v("<span class='tmpzTreeMove_arrow'></span>",j),q.attr("id","zTreeMove_arrow_tmp"),q.appendTo(A),j.treeObj.trigger(s.event.DRAG,[c,j.treeId,o])}if(1==k.dragFlag){if(w&&q.attr("id")==c.target.id&&G&&c.clientX+z.scrollLeft()+2>a("#"+G+s.id.A,w).offset().left){var M=a("#"+G+s.id.A,w);c.target=M.length>0?M.get(0):c.target}else w&&(w.removeClass(s.node.TMPTARGET_TREE),G&&a("#"+G+s.id.A,w).removeClass(s.node.TMPTARGET_NODE+"_"+s.move.TYPE_PREV).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER));w=null,G=null,B=!1,C=j;var N=u.getSettings();for(var O in N)N[O].treeId&&N[O].edit.enable&&N[O].treeId!=j.treeId&&(c.target.id==N[O].treeId||a(c.target).parents("#"+N[O].treeId).length>0)&&(B=!0,C=N[O]);var P=z.scrollTop(),Q=z.scrollLeft(),R=C.treeObj.offset(),S=C.treeObj.get(0).scrollHeight,T=C.treeObj.get(0).scrollWidth,U=c.clientY+P-R.top,V=C.treeObj.height()+R.top-c.clientY-P,W=c.clientX+Q-R.left,X=C.treeObj.width()+R.left-c.clientX-Q,Y=U<j.edit.drag.borderMax&&U>j.edit.drag.borderMin,Z=V<j.edit.drag.borderMax&&V>j.edit.drag.borderMin,$=W<j.edit.drag.borderMax&&W>j.edit.drag.borderMin,_=X<j.edit.drag.borderMax&&X>j.edit.drag.borderMin,aa=U>j.edit.drag.borderMin&&V>j.edit.drag.borderMin&&W>j.edit.drag.borderMin&&X>j.edit.drag.borderMin,ba=Y&&C.treeObj.scrollTop()<=0,ca=Z&&C.treeObj.scrollTop()+C.treeObj.height()+10>=S,da=$&&C.treeObj.scrollLeft()<=0,ea=_&&C.treeObj.scrollLeft()+C.treeObj.width()+10>=T;if(c.target&&r.isChildOrSelf(c.target,C.treeId)){for(var fa=c.target;fa&&fa.tagName&&!r.eqs(fa.tagName,"li")&&fa.id!=C.treeId;)fa=fa.parentNode;var ga=!0;for(e=0,g=o.length;g>e;e++){if(h=o[e],fa.id===h.tId){ga=!1;break}if(v(h,j).find("#"+fa.id).length>0){ga=!1;break}}ga&&c.target&&r.isChildOrSelf(c.target,fa.id+s.id.A)&&(w=a(fa),G=fa.id)}h=o[0],aa&&r.isChildOrSelf(c.target,C.treeId)&&(!w&&(c.target.id==C.treeId||ba||ca||da||ea)&&(B||!B&&h.parentTId)&&(w=C.treeObj),Y?C.treeObj.scrollTop(C.treeObj.scrollTop()-10):Z&&C.treeObj.scrollTop(C.treeObj.scrollTop()+10),$?C.treeObj.scrollLeft(C.treeObj.scrollLeft()-10):_&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+10),w&&w!=C.treeObj&&w.offset().left<C.treeObj.offset().left&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+w.offset().left-C.treeObj.offset().left)),p.css({top:c.clientY+P+3+"px",left:c.clientX+Q+3+"px"});var ha=0,ia=0;if(w&&w.attr("id")!=C.treeId){var ja=null==G?null:u.getNodeCache(C,G),ka=(c.ctrlKey||c.metaKey)&&j.edit.drag.isMove&&j.edit.drag.isCopy||!j.edit.drag.isMove&&j.edit.drag.isCopy,la=!(!x||G!==x.tId),ma=!(!y||G!==y.tId),na=h.parentTId&&h.parentTId==G,oa=(ka||!ma)&&r.apply(C.edit.drag.prev,[C.treeId,o,ja],!!C.edit.drag.prev),pa=(ka||!la)&&r.apply(C.edit.drag.next,[C.treeId,o,ja],!!C.edit.drag.next),qa=(ka||!na)&&!(C.data.keep.leaf&&!u.nodeIsParent(j,ja))&&r.apply(C.edit.drag.inner,[C.treeId,o,ja],!!C.edit.drag.inner);if(oa||pa||qa){var ra=a("#"+G+s.id.A,w),sa=ja.isLastNode?null:a("#"+ja.getNextNode().tId+s.id.A,w.next()),ta=ra.offset().top,ua=ra.offset().left,va=oa?qa?.25:pa?.5:1:-1,wa=pa?qa?.75:oa?.5:0:-1,xa=(c.clientY+P-ta)/ra.height();if((1==va||va>=xa&&xa>=-.2)&&oa?(ha=1-q.width(),ia=ta-q.height()/2,H=s.move.TYPE_PREV):(0==wa||xa>=wa&&1.2>=xa)&&pa?(ha=1-q.width(),ia=null==sa||u.nodeIsParent(j,ja)&&ja.open?ta+ra.height()-q.height()/2:sa.offset().top-q.height()/2,H=s.move.TYPE_NEXT):qa?(ha=5-q.width(),ia=ta,H=s.move.TYPE_INNER):d(),w&&(q.css({display:"block",top:ia+"px",left:ua+ha+"px"}),ra.addClass(s.node.TMPTARGET_NODE+"_"+H),(E!=G||F!=H)&&(K=(new Date).getTime()),ja&&u.nodeIsParent(j,ja)&&H==s.move.TYPE_INNER)){var ya=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==ja.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===ja.tId&&(ya=!1),ya&&(window.zTreeMoveTimer=setTimeout(function(){H==s.move.TYPE_INNER&&ja&&u.nodeIsParent(j,ja)&&!ja.open&&(new Date).getTime()-K>C.edit.drag.autoOpenTime&&r.apply(C.callback.beforeDragOpen,[C.treeId,ja],!0)&&(t.switchNode(C,ja),C.edit.drag.autoExpandTrigger&&C.treeObj.trigger(s.event.EXPAND,[C.treeId,ja]))},C.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=ja.tId)}}else d()}else H=s.move.TYPE_INNER,w&&r.apply(C.edit.drag.inner,[C.treeId,o,null],!!C.edit.drag.inner)?w.addClass(s.node.TMPTARGET_TREE):w=null,q.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);E=G,F=H,j.treeObj.trigger(s.event.DRAGMOVE,[c,j.treeId,o])}return!1}function f(c){function d(){if(B){if(!n)for(var a=0,b=o.length;b>a;a++)t.removeNode(j,o[a]);H==s.move.TYPE_INNER?t.addNodes(C,x,-1,y):t.addNodes(C,x.getParentNode(),H==s.move.TYPE_PREV?x.getIndex():x.getIndex()+1,y)}else if(n&&H==s.move.TYPE_INNER)t.addNodes(C,x,-1,y);else if(n)t.addNodes(C,x.getParentNode(),H==s.move.TYPE_PREV?x.getIndex():x.getIndex()+1,y);else if(H!=s.move.TYPE_NEXT)for(a=0,b=y.length;b>a;a++)t.moveNode(C,x,y[a],H,!1);else for(a=-1,b=y.length-1;b>a;b--)t.moveNode(C,x,y[b],H,!1);t.selectNodes(C,y);var d=v(y[0],j).get(0);t.scrollIntoView(j,d),j.treeObj.trigger(s.event.DROP,[c,C.treeId,y,x,H,n])}if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),E=null,F=null,z.unbind("mousemove",e),z.unbind("mouseup",f),z.unbind("selectstart",g),A.css("cursor",""),w&&(w.removeClass(s.node.TMPTARGET_TREE),G&&a("#"+G+s.id.A,w).removeClass(s.node.TMPTARGET_NODE+"_"+s.move.TYPE_PREV).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER)),r.showIfameMask(j,!1),l.showHoverDom=!0,0!=k.dragFlag){k.dragFlag=0;var h,i,m;for(h=0,i=o.length;i>h;h++)m=o[h],u.nodeIsParent(j,m)&&k.dragNodeShowBefore[m.tId]&&!m.open&&(t.expandCollapseNode(j,m,!m.open),delete k.dragNodeShowBefore[m.tId]);p&&p.remove(),q&&q.remove();var n=(c.ctrlKey||c.metaKey)&&j.edit.drag.isMove&&j.edit.drag.isCopy||!j.edit.drag.isMove&&j.edit.drag.isCopy;if(!n&&w&&G&&o[0].parentTId&&G==o[0].parentTId&&H==s.move.TYPE_INNER&&(w=null),w){var x=null==G?null:u.getNodeCache(C,G);if(0==r.apply(j.callback.beforeDrop,[C.treeId,o,x,H,n],!0))return void t.selectNodes(D,o);var y=n?r.clone(o):o;H==s.move.TYPE_INNER&&r.canAsync(C,x)?t.asyncNode(C,x,!1,d):d()}else t.selectNodes(D,o),j.treeObj.trigger(s.event.DROP,[c,j.treeId,o,null,null,null])}}function g(){return!1}var h,i,j=u.getSetting(c.data.treeId),k=u.getRoot(j),l=u.getRoots();if(2==c.button||!j.edit.enable||!j.edit.drag.isCopy&&!j.edit.drag.isMove)return!0;var m=c.target,n=u.getRoot(j).curSelectedList,o=[];if(u.isSelectedNode(j,d))for(h=0,i=n.length;i>h;h++){if(n[h].editNameFlag&&r.eqs(m.tagName,"input")&&null!==m.getAttribute("treeNode"+s.id.INPUT))return!0;if(o.push(n[h]),o[0].parentTId!==n[h].parentTId){o=[d];break}}else o=[d];t.editNodeBlur=!0,t.cancelCurEditNode(j);var p,q,w,x,y,z=a(j.treeObj.get(0).ownerDocument),A=a(j.treeObj.get(0).ownerDocument.body),B=!1,C=j,D=j,E=null,F=null,G=null,H=s.move.TYPE_INNER,I=c.clientX,J=c.clientY,K=(new Date).getTime();return r.uCanDo(j)&&z.bind("mousemove",e),z.bind("mouseup",f),z.bind("selectstart",g),!0}},n={getAbs:function(a){var b=a.getBoundingClientRect(),c=document.body.scrollTop+document.documentElement.scrollTop,d=document.body.scrollLeft+document.documentElement.scrollLeft;return[b.left+d,b.top+c]},inputFocus:function(a){a.get(0)&&(a.focus(),r.setCursorPosition(a.get(0),a.val().length))},inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},showIfameMask:function(a,b){for(var c=u.getRoot(a);c.dragMaskList.length>0;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(b)for(var d=v("iframe",a),e=0,f=d.length;f>e;e++){var g=d.get(e),h=r.getAbs(g),i=v("<div id='zTreeMask_"+e+"' class='zTreeMask' style='top:"+h[1]+"px; left:"+h[0]+"px; width:"+g.offsetWidth+"px; height:"+g.offsetHeight+"px;'></div>",a);i.appendTo(v("body",a)),c.dragMaskList.push(i)}}},o={addEditBtn:function(a,b){if(!(b.editNameFlag||v(b,s.id.EDIT,a).length>0)&&r.apply(a.edit.showRenameBtn,[a.treeId,b],a.edit.showRenameBtn)){var c=v(b,s.id.A,a),d="<span class='"+s.className.BUTTON+" edit' id='"+b.tId+s.id.EDIT+"' title='"+r.apply(a.edit.renameTitle,[a.treeId,b],a.edit.renameTitle)+"' treeNode"+s.id.EDIT+" style='display:none;'></span>";c.append(d),v(b,s.id.EDIT,a).bind("click",function(){return r.uCanDo(a)&&0!=r.apply(a.callback.beforeEditName,[a.treeId,b],!0)?(t.editNode(a,b),!1):!1}).show()}},addRemoveBtn:function(a,b){if(!(b.editNameFlag||v(b,s.id.REMOVE,a).length>0)&&r.apply(a.edit.showRemoveBtn,[a.treeId,b],a.edit.showRemoveBtn)){var c=v(b,s.id.A,a),d="<span class='"+s.className.BUTTON+" remove' id='"+b.tId+s.id.REMOVE+"' title='"+r.apply(a.edit.removeTitle,[a.treeId,b],a.edit.removeTitle)+"' treeNode"+s.id.REMOVE+" style='display:none;'></span>";c.append(d),v(b,s.id.REMOVE,a).bind("click",function(){return r.uCanDo(a)&&0!=r.apply(a.callback.beforeRemove,[a.treeId,b],!0)?(t.removeNode(a,b),a.treeObj.trigger(s.event.REMOVE,[a.treeId,b]),!1):!1}).bind("mousedown",function(a){return!0}).show()}},addHoverDom:function(a,b){u.getRoots().showHoverDom&&(b.isHover=!0,a.edit.enable&&(t.addEditBtn(a,b),t.addRemoveBtn(a,b)),r.apply(a.view.addHoverDom,[a.treeId,b]))},cancelCurEditNode:function(a,b,c){var d=u.getRoot(a),e=d.curEditNode;if(e){var f=d.curEditInput,g=b?b:c?u.nodeName(a,e):f.val();if(r.apply(a.callback.beforeRename,[a.treeId,e,g,c],!0)===!1)return!1;u.nodeName(a,e,g);var h=v(e,s.id.A,a);h.removeClass(s.node.CURSELECTED_EDIT),f.unbind(),t.setNodeName(a,e),e.editNameFlag=!1,d.curEditNode=null,d.curEditInput=null,t.selectNode(a,e,!1),a.treeObj.trigger(s.event.RENAME,[a.treeId,e,c])}return d.noSelection=!0,!0},editNode:function(a,b){var c=u.getRoot(a);if(t.editNodeBlur=!1,u.isSelectedNode(a,b)&&c.curEditNode==b&&b.editNameFlag)return void setTimeout(function(){r.inputFocus(c.curEditInput)},0);b.editNameFlag=!0,t.removeTreeDom(a,b),t.cancelCurEditNode(a),t.selectNode(a,b,!1),v(b,s.id.SPAN,a).html("<input type=text class='rename' id='"+b.tId+s.id.INPUT+"' treeNode"+s.id.INPUT+" >");var d=v(b,s.id.INPUT,a);d.attr("value",u.nodeName(a,b)),a.edit.editNameSelectAll?r.inputSelect(d):r.inputFocus(d),d.bind("blur",function(b){t.editNodeBlur||t.cancelCurEditNode(a)}).bind("keydown",function(b){"13"==b.keyCode?(t.editNodeBlur=!0,t.cancelCurEditNode(a)):"27"==b.keyCode&&t.cancelCurEditNode(a,null,!0)}).bind("click",function(a){return!1}).bind("dblclick",function(a){return!1}),v(b,s.id.A,a).addClass(s.node.CURSELECTED_EDIT),c.curEditInput=d,c.noSelection=!1,c.curEditNode=b},moveNode:function(a,b,c,d,e,f){var g=u.getRoot(a);if(b!=c&&(!a.data.keep.leaf||!b||u.nodeIsParent(a,b)||d!=s.move.TYPE_INNER)){var h=c.parentTId?c.getParentNode():g,i=null===b||b==g;i&&null===b&&(b=g),i&&(d=s.move.TYPE_INNER);var j=b.parentTId?b.getParentNode():g;d!=s.move.TYPE_PREV&&d!=s.move.TYPE_NEXT&&(d=s.move.TYPE_INNER),d==s.move.TYPE_INNER&&(i?c.parentTId=null:(u.nodeIsParent(a,b)||(u.nodeIsParent(a,b,!0),b.open=!!b.open,t.setNodeLineIcos(a,b)),c.parentTId=b.tId));var k,l;if(i)k=a.treeObj,l=k;else{if(f||d!=s.move.TYPE_INNER?f||t.expandCollapseNode(a,b.getParentNode(),!0,!1):t.expandCollapseNode(a,b,!0,!1),k=v(b,a),l=v(b,s.id.UL,a),k.get(0)&&!l.get(0)){var m=[];t.makeUlHtml(a,b,m,""),k.append(m.join(""))}l=v(b,s.id.UL,a)}var n=v(c,a);n.get(0)?k.get(0)||n.remove():n=t.appendNodes(a,c.level,[c],null,-1,!1,!0).join(""),l.get(0)&&d==s.move.TYPE_INNER?l.append(n):k.get(0)&&d==s.move.TYPE_PREV?k.before(n):k.get(0)&&d==s.move.TYPE_NEXT&&k.after(n);var o,p,q=-1,r=0,w=null,x=null,y=c.level,z=u.nodeChildren(a,h),A=u.nodeChildren(a,j),B=u.nodeChildren(a,b);
if(c.isFirstNode)q=0,z.length>1&&(w=z[1],w.isFirstNode=!0);else if(c.isLastNode)q=z.length-1,w=z[q-1],w.isLastNode=!0;else for(o=0,p=z.length;p>o;o++)if(z[o].tId==c.tId){q=o;break}if(q>=0&&z.splice(q,1),d!=s.move.TYPE_INNER)for(o=0,p=A.length;p>o;o++)A[o].tId==b.tId&&(r=o);if(d==s.move.TYPE_INNER?(B||(B=u.nodeChildren(a,b,[])),B.length>0&&(x=B[B.length-1],x.isLastNode=!1),B.splice(B.length,0,c),c.isLastNode=!0,c.isFirstNode=1==B.length):b.isFirstNode&&d==s.move.TYPE_PREV?(A.splice(r,0,c),x=b,x.isFirstNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!0,c.isLastNode=!1):b.isLastNode&&d==s.move.TYPE_NEXT?(A.splice(r+1,0,c),x=b,x.isLastNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(d==s.move.TYPE_PREV?A.splice(r,0,c):A.splice(r+1,0,c),c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!1),u.fixPIdKeyValue(a,c),u.setSonNodeLevel(a,c.getParentNode(),c),t.setNodeLineIcos(a,c),t.repairNodeLevelClass(a,c,y),!a.data.keep.parent&&z.length<1){u.nodeIsParent(a,h,!1),h.open=!1;var C=v(h,s.id.UL,a),D=v(h,s.id.SWITCH,a),E=v(h,s.id.ICON,a);t.replaceSwitchClass(h,D,s.folder.DOCU),t.replaceIcoClass(h,E,s.folder.DOCU),C.css("display","none")}else w&&t.setNodeLineIcos(a,w);x&&t.setNodeLineIcos(a,x),a.check&&a.check.enable&&t.repairChkClass&&(t.repairChkClass(a,h),t.repairParentChkClassWithSelf(a,h),h!=c.parent&&t.repairParentChkClassWithSelf(a,c)),f||t.expandCollapseParentNode(a,c.getParentNode(),!0,e)}},removeEditBtn:function(a,b){v(b,s.id.EDIT,a).unbind().remove()},removeRemoveBtn:function(a,b){v(b,s.id.REMOVE,a).unbind().remove()},removeTreeDom:function(a,b){b.isHover=!1,t.removeEditBtn(a,b),t.removeRemoveBtn(a,b),r.apply(a.view.removeHoverDom,[a.treeId,b])},repairNodeLevelClass:function(a,b,c){if(c!==b.level){var d=v(b,a),e=v(b,s.id.A,a),f=v(b,s.id.UL,a),g=s.className.LEVEL+c,h=s.className.LEVEL+b.level;d.removeClass(g),d.addClass(h),e.removeClass(g),e.addClass(h),f.removeClass(g),f.addClass(h)}},selectNodes:function(a,b){for(var c=0,d=b.length;d>c;c++)t.selectNode(a,b[c],c>0)}},p={tools:n,view:o,event:l,data:k};a.extend(!0,a.fn.zTree.consts,b),a.extend(!0,a.fn.zTree._z,p);var q=a.fn.zTree,r=q._z.tools,s=q.consts,t=q._z.view,u=q._z.data,v=(q._z.event,r.$);u.exSetting(c),u.addInitBind(f),u.addInitUnBind(g),u.addInitCache(e),u.addInitNode(i),u.addInitProxy(h),u.addInitRoot(d),u.addZTreeTools(j);var w=t.cancelPreSelectedNode;t.cancelPreSelectedNode=function(a,b){for(var c=u.getRoot(a).curSelectedList,d=0,e=c.length;e>d&&(b&&b!==c[d]||(t.removeTreeDom(a,c[d]),!b));d++);w&&w.apply(t,arguments)};var x=t.createNodes;t.createNodes=function(a,b,c,d,e){x&&x.apply(t,arguments),c&&t.repairParentChkClassWithSelf&&t.repairParentChkClassWithSelf(a,d)};var y=t.makeNodeUrl;t.makeNodeUrl=function(a,b){return a.edit.enable?null:y.apply(t,arguments)};var z=t.removeNode;t.removeNode=function(a,b){var c=u.getRoot(a);c.curEditNode===b&&(c.curEditNode=null),z&&z.apply(t,arguments)};var A=t.selectNode;t.selectNode=function(a,b,c){var d=u.getRoot(a);return u.isSelectedNode(a,b)&&d.curEditNode==b&&b.editNameFlag?!1:(A&&A.apply(t,arguments),t.addHoverDom(a,b),!0)};var B=r.uCanDo;r.uCanDo=function(a,b){var c=u.getRoot(a);return b&&(r.eqs(b.type,"mouseover")||r.eqs(b.type,"mouseout")||r.eqs(b.type,"mousedown")||r.eqs(b.type,"mouseup"))?!0:(c.curEditNode&&(t.editNodeBlur=!1,c.curEditInput.focus()),!c.curEditNode&&(B?B.apply(t,arguments):!0))}}(jQuery);